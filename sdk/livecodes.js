var V=Object.create;var Q=Object.defineProperty;var ee=Object.getOwnPropertyDescriptor;var te=Object.getOwnPropertyNames;var oe=Object.getPrototypeOf,ne=Object.prototype.hasOwnProperty;var re=(c,E)=>()=>(E||c((E={exports:{}}).exports,E),E.exports);var se=(c,E,P,S)=>{if(E&&typeof E=="object"||typeof E=="function")for(let y of te(E))!ne.call(c,y)&&y!==P&&Q(c,y,{get:()=>E[y],enumerable:!(S=ee(E,y))||S.enumerable});return c};var ie=(c,E,P)=>(P=c!=null?V(oe(c)):{},se(E||!c||!c.__esModule?Q(P,"default",{value:c,enumerable:!0}):P,c));var $=re((de,R)=>{var ae=function(){var c=String.fromCharCode,E="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",P="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",S={};function y(o,n){if(!S[o]){S[o]={};for(var d=0;d<o.length;d++)S[o][o.charAt(d)]=d}return S[o][n]}var x={compressToBase64:function(o){if(o==null)return"";var n=x._compress(o,6,function(d){return E.charAt(d)});switch(n.length%4){default:case 0:return n;case 1:return n+"===";case 2:return n+"==";case 3:return n+"="}},decompressFromBase64:function(o){return o==null?"":o==""?null:x._decompress(o.length,32,function(n){return y(E,o.charAt(n))})},compressToUTF16:function(o){return o==null?"":x._compress(o,15,function(n){return c(n+32)})+" "},decompressFromUTF16:function(o){return o==null?"":o==""?null:x._decompress(o.length,16384,function(n){return o.charCodeAt(n)-32})},compressToUint8Array:function(o){for(var n=x.compress(o),d=new Uint8Array(n.length*2),s=0,i=n.length;s<i;s++){var m=n.charCodeAt(s);d[s*2]=m>>>8,d[s*2+1]=m%256}return d},decompressFromUint8Array:function(o){if(o==null)return x.decompress(o);for(var n=new Array(o.length/2),d=0,s=n.length;d<s;d++)n[d]=o[d*2]*256+o[d*2+1];var i=[];return n.forEach(function(m){i.push(c(m))}),x.decompress(i.join(""))},compressToEncodedURIComponent:function(o){return o==null?"":x._compress(o,6,function(n){return P.charAt(n)})},decompressFromEncodedURIComponent:function(o){return o==null?"":o==""?null:(o=o.replace(/ /g,"+"),x._decompress(o.length,32,function(n){return y(P,o.charAt(n))}))},compress:function(o){return x._compress(o,16,function(n){return c(n)})},_compress:function(o,n,d){if(o==null)return"";var s,i,m={},f={},h="",A="",g="",b=2,T=3,a=2,u=[],t=0,e=0,w;for(w=0;w<o.length;w+=1)if(h=o.charAt(w),Object.prototype.hasOwnProperty.call(m,h)||(m[h]=T++,f[h]=!0),A=g+h,Object.prototype.hasOwnProperty.call(m,A))g=A;else{if(Object.prototype.hasOwnProperty.call(f,g)){if(g.charCodeAt(0)<256){for(s=0;s<a;s++)t=t<<1,e==n-1?(e=0,u.push(d(t)),t=0):e++;for(i=g.charCodeAt(0),s=0;s<8;s++)t=t<<1|i&1,e==n-1?(e=0,u.push(d(t)),t=0):e++,i=i>>1}else{for(i=1,s=0;s<a;s++)t=t<<1|i,e==n-1?(e=0,u.push(d(t)),t=0):e++,i=0;for(i=g.charCodeAt(0),s=0;s<16;s++)t=t<<1|i&1,e==n-1?(e=0,u.push(d(t)),t=0):e++,i=i>>1}b--,b==0&&(b=Math.pow(2,a),a++),delete f[g]}else for(i=m[g],s=0;s<a;s++)t=t<<1|i&1,e==n-1?(e=0,u.push(d(t)),t=0):e++,i=i>>1;b--,b==0&&(b=Math.pow(2,a),a++),m[A]=T++,g=String(h)}if(g!==""){if(Object.prototype.hasOwnProperty.call(f,g)){if(g.charCodeAt(0)<256){for(s=0;s<a;s++)t=t<<1,e==n-1?(e=0,u.push(d(t)),t=0):e++;for(i=g.charCodeAt(0),s=0;s<8;s++)t=t<<1|i&1,e==n-1?(e=0,u.push(d(t)),t=0):e++,i=i>>1}else{for(i=1,s=0;s<a;s++)t=t<<1|i,e==n-1?(e=0,u.push(d(t)),t=0):e++,i=0;for(i=g.charCodeAt(0),s=0;s<16;s++)t=t<<1|i&1,e==n-1?(e=0,u.push(d(t)),t=0):e++,i=i>>1}b--,b==0&&(b=Math.pow(2,a),a++),delete f[g]}else for(i=m[g],s=0;s<a;s++)t=t<<1|i&1,e==n-1?(e=0,u.push(d(t)),t=0):e++,i=i>>1;b--,b==0&&(b=Math.pow(2,a),a++)}for(i=2,s=0;s<a;s++)t=t<<1|i&1,e==n-1?(e=0,u.push(d(t)),t=0):e++,i=i>>1;for(;;)if(t=t<<1,e==n-1){u.push(d(t));break}else e++;return u.join("")},decompress:function(o){return o==null?"":o==""?null:x._decompress(o.length,32768,function(n){return o.charCodeAt(n)})},_decompress:function(o,n,d){var s=[],i,m=4,f=4,h=3,A="",g=[],b,T,a,u,t,e,w,l={val:d(0),position:n,index:1};for(b=0;b<3;b+=1)s[b]=b;for(a=0,t=Math.pow(2,2),e=1;e!=t;)u=l.val&l.position,l.position>>=1,l.position==0&&(l.position=n,l.val=d(l.index++)),a|=(u>0?1:0)*e,e<<=1;switch(i=a){case 0:for(a=0,t=Math.pow(2,8),e=1;e!=t;)u=l.val&l.position,l.position>>=1,l.position==0&&(l.position=n,l.val=d(l.index++)),a|=(u>0?1:0)*e,e<<=1;w=c(a);break;case 1:for(a=0,t=Math.pow(2,16),e=1;e!=t;)u=l.val&l.position,l.position>>=1,l.position==0&&(l.position=n,l.val=d(l.index++)),a|=(u>0?1:0)*e,e<<=1;w=c(a);break;case 2:return""}for(s[3]=w,T=w,g.push(w);;){if(l.index>o)return"";for(a=0,t=Math.pow(2,h),e=1;e!=t;)u=l.val&l.position,l.position>>=1,l.position==0&&(l.position=n,l.val=d(l.index++)),a|=(u>0?1:0)*e,e<<=1;switch(w=a){case 0:for(a=0,t=Math.pow(2,8),e=1;e!=t;)u=l.val&l.position,l.position>>=1,l.position==0&&(l.position=n,l.val=d(l.index++)),a|=(u>0?1:0)*e,e<<=1;s[f++]=c(a),w=f-1,m--;break;case 1:for(a=0,t=Math.pow(2,16),e=1;e!=t;)u=l.val&l.position,l.position>>=1,l.position==0&&(l.position=n,l.val=d(l.index++)),a|=(u>0?1:0)*e,e<<=1;s[f++]=c(a),w=f-1,m--;break;case 2:return g.join("")}if(m==0&&(m=Math.pow(2,h),h++),s[w])A=s[w];else if(w===f)A=T+T.charAt(0);else return null;g.push(A),s[f++]=T+A.charAt(0),m--,T=A,m==0&&(m=Math.pow(2,h),h++)}}};return x}();typeof R!="undefined"&&R!=null&&(R.exports=ae)});var F=ie($());async function le(c,E={}){typeof c=="object"&&!(c instanceof HTMLElement)&&c.view==="headless"&&(E=c,c=null);let{appUrl:P="https://livecodes.io/",params:S={},config:y={},import:x,headless:o,lite:n,loading:d="lazy",template:s,view:i}=E,m=o||i==="headless",f=null;if(typeof c=="string")f=document.querySelector(c);else if(c instanceof HTMLElement)f=c;else if(!(m&&typeof c=="object"))throw new Error("A valid container element is required.");if(!f)if(m)f=document.createElement("div"),z(f),document.body.appendChild(f);else throw new Error(`Cannot find element: "${c}"`);let h;try{h=new URL(P)}catch(r){throw new Error(`"${P}" is not a valid URL.`)}let A=h.origin;if(typeof S=="object"&&Object.keys(S).forEach(r=>{h.searchParams.set(r,String(S[r]))}),s&&h.searchParams.set("template",s),x&&h.searchParams.set("x",x),m&&h.searchParams.set("headless","true"),n&&(console.warn(`Deprecation notice: "lite" option is deprecated. Use "config: { mode: 'lite' }" instead.`),typeof y=="object"&&y.mode==null?y.mode="lite":h.searchParams.set("lite","true")),i&&(console.warn('Deprecation notice: The "view" option has been moved to "config.view". For headless mode use "headless: true".'),typeof y=="object"&&y.view==null&&i!=="headless"?y.view=i:h.searchParams.set("view",i)),typeof y=="string")try{new URL(y),h.searchParams.set("config",y)}catch(r){throw new Error('"config" is not a valid URL or configuration object.')}else if(typeof y=="object")Object.keys(y).length>0&&h.searchParams.set("config","sdk");else throw new Error('"config" is not a valid URL or configuration object.');h.searchParams.set("embed","true"),h.searchParams.set("loading",m?"eager":d);let g=!1,b="Cannot call API methods after calling `destroy()`.",a=await new Promise(r=>{var H,O,_,C,j,W,B,q,J;if(!f)return;let v=f.dataset.height||f.style.height;if(v&&!m){let k=isNaN(Number(v))?v:v+"px";f.style.height=k}f.dataset.defaultStyles!=="false"&&!m&&((H=f.style).backgroundColor||(H.backgroundColor="#fff"),(O=f.style).border||(O.border="1px solid black"),(_=f.style).borderRadius||(_.borderRadius="8px"),(C=f.style).boxSizing||(C.boxSizing="border-box"),(j=f.style).padding||(j.padding="0"),(W=f.style).width||(W.width="100%"),(B=f.style).height||(B.height=f.style.height||"300px"),f.style.minHeight="200px",f.style.flexGrow="1",(q=f.style).overflow||(q.overflow="hidden"),(J=f.style).resize||(J.resize="vertical"));let L="livecodes",M=f.querySelector(`iframe.${L}`),p=M||document.createElement("iframe");p.classList.add(L),p.setAttribute("allow","accelerometer; camera; encrypted-media; display-capture; geolocation; gyroscope; microphone; midi; clipboard-read; clipboard-write; web-share"),p.setAttribute("allowtransparency","true"),p.setAttribute("allowpaymentrequest","true"),p.setAttribute("allowfullscreen","true"),p.setAttribute("sandbox","allow-same-origin allow-downloads allow-forms allow-modals allow-orientation-lock allow-pointer-lock allow-popups allow-presentation allow-scripts");let U=d==="eager"?"eager":"lazy";p.setAttribute("loading",U),m?z(p):(p.style.height="100%",p.style.minHeight="200px",p.style.width="100%",p.style.margin="0",p.style.border="0",p.style.borderRadius=f.style.borderRadius),addEventListener("message",function k(D){var N,Z;D.source!==p.contentWindow||D.origin!==A||((N=D.data)==null?void 0:N.type)!=="livecodes-get-config"||(removeEventListener("message",k),(Z=p.contentWindow)==null||Z.postMessage({type:"livecodes-config",payload:y},A))}),p.onload=()=>{r(p)},p.src=h.href,M||f.appendChild(p)}),u=new Promise(r=>{addEventListener("message",function v(L){var M;L.source!==a.contentWindow||L.origin!==A||((M=L.data)==null?void 0:M.type)!=="livecodes-ready"||(removeEventListener("message",v),r(),u.settled=!0)})}),t=()=>g?Promise.reject(b):new Promise(async r=>{var L;u.settled&&r();let v={type:"livecodes-load"};(L=a.contentWindow)==null||L.postMessage(v,A),await u,r()}),e=(r,v)=>new Promise(async(L,M)=>{var U;if(g)return M(b);await t();let p=Y();addEventListener("message",function H(O){var _,C;if(!(O.source!==a.contentWindow||O.origin!==A||((_=O.data)==null?void 0:_.type)!=="livecodes-api-response"||((C=O.data)==null?void 0:C.id)!==p)&&O.data.method===r){removeEventListener("message",H);let j=O.data.payload;j!=null&&j.error?M(j.error):L(j)}}),(U=a.contentWindow)==null||U.postMessage({method:r,id:p,args:v},A)}),w={},l=["load","ready","code","console","tests","destroy"],I=(r,v)=>{var L;if(g)throw new Error(b);return l.includes(r)?(e("watch",[r]),w[r]||(w[r]=[]),(L=w[r])==null||L.push(v),{remove:()=>{var M,p;w[r]=(M=w[r])==null?void 0:M.filter(U=>U!==v),((p=w[r])==null?void 0:p.length)===0&&e("watch",[r,"unsubscribe"])}}):{remove:()=>{}}},X=r=>({"livecodes-app-loaded":"load","livecodes-ready":"ready","livecodes-change":"code","livecodes-console":"console","livecodes-test-results":"tests","livecodes-destroy":"destroy"})[r];addEventListener("message",async r=>{var M,p,U,H;let v=X((p=(M=r.data)==null?void 0:M.type)!=null?p:"");if(r.source!==a.contentWindow||r.origin!==A||!v||!w[v])return;let L=(U=r.data)==null?void 0:U.payload;(H=w[v])==null||H.forEach(O=>{O(L)})});let K=()=>{var r;Object.values(w).forEach(v=>{v.length=0}),(r=a==null?void 0:a.remove)==null||r.call(a),g=!0};d==="lazy"&&"IntersectionObserver"in window&&new IntersectionObserver((v,L)=>{v.forEach(async M=>{M.isIntersecting&&(await t(),L.unobserve(f))})},{rootMargin:"150px"}).observe(f);function z(r){r.style.position="absolute",r.style.top="0",r.style.visibility="hidden",r.style.opacity="0"}let Y=()=>(String(Math.random())+Date.now().toFixed()).replace("0.","");return{load:()=>t(),run:()=>e("run"),format:r=>e("format",[r]),getShareUrl:r=>e("getShareUrl",[r]),getConfig:r=>e("getConfig",[r]),setConfig:r=>e("setConfig",[r]),getCode:()=>e("getCode"),show:(r,v)=>e("show",[r,v]),runTests:()=>e("runTests"),onChange:r=>I("code",r),watch:I,exec:(r,...v)=>e("exec",[r,...v]),destroy:()=>u.settled?e("destroy").then(K):g?Promise.reject(b):(K(),Promise.resolve())}}function fe(c={}){let{appUrl:E,params:P,config:S,import:y,...x}=c,o=typeof S=="string"?{config:S}:typeof S=="object"?{x:"code/"+(0,F.compressToEncodedURIComponent)(JSON.stringify(S))}:{},n=new URLSearchParams(JSON.parse(JSON.stringify({...x,...P,x:y,...o}))).toString();return(E||"https://livecodes.io")+(n?"?"+n:"")}var G;globalThis.document&&document.currentScript&&"prefill"in((G=document.currentScript)==null?void 0:G.dataset)&&window.addEventListener("load",()=>{document.querySelectorAll(".livecodes").forEach(c=>{let E,P=c.dataset.options;if(P)try{E=JSON.parse(P)}catch(o){}let S,y=c.dataset.config||c.dataset.prefill;if(y)try{S=JSON.parse(y)}catch(o){}let x=encodeURIComponent(c.outerHTML);c.innerHTML="",le(c,{import:"dom/"+x,...E,...S?{config:S}:{}})})});export{le as createPlayground,fe as getPlaygroundUrl};
