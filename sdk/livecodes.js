var V=Object.create;var $=Object.defineProperty;var ee=Object.getOwnPropertyDescriptor;var te=Object.getOwnPropertyNames;var oe=Object.getPrototypeOf,ne=Object.prototype.hasOwnProperty;var re=(d,E)=>()=>(E||d((E={exports:{}}).exports,E),E.exports);var se=(d,E,x,b)=>{if(E&&typeof E=="object"||typeof E=="function")for(let g of te(E))!ne.call(d,g)&&g!==x&&$(d,g,{get:()=>E[g],enumerable:!(b=ee(E,g))||b.enumerable});return d};var ie=(d,E,x)=>(x=d!=null?V(oe(d)):{},se(E||!d||!d.__esModule?$(x,"default",{value:d,enumerable:!0}):x,d));var G=re((de,_)=>{var ae=function(){var d=String.fromCharCode,E="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",x="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",b={};function g(o,n){if(!b[o]){b[o]={};for(var c=0;c<o.length;c++)b[o][o.charAt(c)]=c}return b[o][n]}var P={compressToBase64:function(o){if(o==null)return"";var n=P._compress(o,6,function(c){return E.charAt(c)});switch(n.length%4){default:case 0:return n;case 1:return n+"===";case 2:return n+"==";case 3:return n+"="}},decompressFromBase64:function(o){return o==null?"":o==""?null:P._decompress(o.length,32,function(n){return g(E,o.charAt(n))})},compressToUTF16:function(o){return o==null?"":P._compress(o,15,function(n){return d(n+32)})+" "},decompressFromUTF16:function(o){return o==null?"":o==""?null:P._decompress(o.length,16384,function(n){return o.charCodeAt(n)-32})},compressToUint8Array:function(o){for(var n=P.compress(o),c=new Uint8Array(n.length*2),r=0,i=n.length;r<i;r++){var m=n.charCodeAt(r);c[r*2]=m>>>8,c[r*2+1]=m%256}return c},decompressFromUint8Array:function(o){if(o==null)return P.decompress(o);for(var n=new Array(o.length/2),c=0,r=n.length;c<r;c++)n[c]=o[c*2]*256+o[c*2+1];var i=[];return n.forEach(function(m){i.push(d(m))}),P.decompress(i.join(""))},compressToEncodedURIComponent:function(o){return o==null?"":P._compress(o,6,function(n){return x.charAt(n)})},decompressFromEncodedURIComponent:function(o){return o==null?"":o==""?null:(o=o.replace(/ /g,"+"),P._decompress(o.length,32,function(n){return g(x,o.charAt(n))}))},compress:function(o){return P._compress(o,16,function(n){return d(n)})},_compress:function(o,n,c){if(o==null)return"";var r,i,m={},f={},h="",A="",w="",S=2,U=3,a=2,p=[],t=0,e=0,v;for(v=0;v<o.length;v+=1)if(h=o.charAt(v),Object.prototype.hasOwnProperty.call(m,h)||(m[h]=U++,f[h]=!0),A=w+h,Object.prototype.hasOwnProperty.call(m,A))w=A;else{if(Object.prototype.hasOwnProperty.call(f,w)){if(w.charCodeAt(0)<256){for(r=0;r<a;r++)t=t<<1,e==n-1?(e=0,p.push(c(t)),t=0):e++;for(i=w.charCodeAt(0),r=0;r<8;r++)t=t<<1|i&1,e==n-1?(e=0,p.push(c(t)),t=0):e++,i=i>>1}else{for(i=1,r=0;r<a;r++)t=t<<1|i,e==n-1?(e=0,p.push(c(t)),t=0):e++,i=0;for(i=w.charCodeAt(0),r=0;r<16;r++)t=t<<1|i&1,e==n-1?(e=0,p.push(c(t)),t=0):e++,i=i>>1}S--,S==0&&(S=Math.pow(2,a),a++),delete f[w]}else for(i=m[w],r=0;r<a;r++)t=t<<1|i&1,e==n-1?(e=0,p.push(c(t)),t=0):e++,i=i>>1;S--,S==0&&(S=Math.pow(2,a),a++),m[A]=U++,w=String(h)}if(w!==""){if(Object.prototype.hasOwnProperty.call(f,w)){if(w.charCodeAt(0)<256){for(r=0;r<a;r++)t=t<<1,e==n-1?(e=0,p.push(c(t)),t=0):e++;for(i=w.charCodeAt(0),r=0;r<8;r++)t=t<<1|i&1,e==n-1?(e=0,p.push(c(t)),t=0):e++,i=i>>1}else{for(i=1,r=0;r<a;r++)t=t<<1|i,e==n-1?(e=0,p.push(c(t)),t=0):e++,i=0;for(i=w.charCodeAt(0),r=0;r<16;r++)t=t<<1|i&1,e==n-1?(e=0,p.push(c(t)),t=0):e++,i=i>>1}S--,S==0&&(S=Math.pow(2,a),a++),delete f[w]}else for(i=m[w],r=0;r<a;r++)t=t<<1|i&1,e==n-1?(e=0,p.push(c(t)),t=0):e++,i=i>>1;S--,S==0&&(S=Math.pow(2,a),a++)}for(i=2,r=0;r<a;r++)t=t<<1|i&1,e==n-1?(e=0,p.push(c(t)),t=0):e++,i=i>>1;for(;;)if(t=t<<1,e==n-1){p.push(c(t));break}else e++;return p.join("")},decompress:function(o){return o==null?"":o==""?null:P._decompress(o.length,32768,function(n){return o.charCodeAt(n)})},_decompress:function(o,n,c){var r=[],i,m=4,f=4,h=3,A="",w=[],S,U,a,p,t,e,v,l={val:c(0),position:n,index:1};for(S=0;S<3;S+=1)r[S]=S;for(a=0,t=Math.pow(2,2),e=1;e!=t;)p=l.val&l.position,l.position>>=1,l.position==0&&(l.position=n,l.val=c(l.index++)),a|=(p>0?1:0)*e,e<<=1;switch(i=a){case 0:for(a=0,t=Math.pow(2,8),e=1;e!=t;)p=l.val&l.position,l.position>>=1,l.position==0&&(l.position=n,l.val=c(l.index++)),a|=(p>0?1:0)*e,e<<=1;v=d(a);break;case 1:for(a=0,t=Math.pow(2,16),e=1;e!=t;)p=l.val&l.position,l.position>>=1,l.position==0&&(l.position=n,l.val=c(l.index++)),a|=(p>0?1:0)*e,e<<=1;v=d(a);break;case 2:return""}for(r[3]=v,U=v,w.push(v);;){if(l.index>o)return"";for(a=0,t=Math.pow(2,h),e=1;e!=t;)p=l.val&l.position,l.position>>=1,l.position==0&&(l.position=n,l.val=c(l.index++)),a|=(p>0?1:0)*e,e<<=1;switch(v=a){case 0:for(a=0,t=Math.pow(2,8),e=1;e!=t;)p=l.val&l.position,l.position>>=1,l.position==0&&(l.position=n,l.val=c(l.index++)),a|=(p>0?1:0)*e,e<<=1;r[f++]=d(a),v=f-1,m--;break;case 1:for(a=0,t=Math.pow(2,16),e=1;e!=t;)p=l.val&l.position,l.position>>=1,l.position==0&&(l.position=n,l.val=c(l.index++)),a|=(p>0?1:0)*e,e<<=1;r[f++]=d(a),v=f-1,m--;break;case 2:return w.join("")}if(m==0&&(m=Math.pow(2,h),h++),r[v])A=r[v];else if(v===f)A=U+U.charAt(0);else return null;w.push(A),r[f++]=U+A.charAt(0),m--,U=A,m==0&&(m=Math.pow(2,h),h++)}}};return P}();typeof _!="undefined"&&_!=null&&(_.exports=ae)});var k=ie(G());async function le(d,E={}){typeof d=="object"&&!(d instanceof HTMLElement)&&d.view==="headless"&&(E=d,d=null);let{appUrl:x="https://livecodes.io/",params:b={},config:g={},import:P,headless:o,lite:n,loading:c="lazy",template:r,view:i}=E,m=o||i==="headless",f=null;if(typeof d=="string")f=document.querySelector(d);else if(d instanceof HTMLElement)f=d;else if(!(m&&typeof d=="object"))throw new Error("A valid container element is required.");if(!f)if(m)f=document.createElement("div"),J(f),document.body.appendChild(f);else throw new Error(`Cannot find element: "${d}"`);let h;try{h=new URL(x)}catch(s){throw new Error(`"${x}" is not a valid URL.`)}let A=h.origin;if(b&&typeof b=="object")try{h.searchParams.set("params",(0,k.compressToEncodedURIComponent)(JSON.stringify(b)))}catch(s){Object.keys(b).forEach(y=>{h.searchParams.set(y,encodeURIComponent(String(b[y])))})}if(r&&h.searchParams.set("template",r),P&&h.searchParams.set("x",encodeURIComponent(P)),m&&h.searchParams.set("headless","true"),n&&(console.warn(`Deprecation notice: "lite" option is deprecated. Use "config: { mode: 'lite' }" instead.`),typeof g=="object"&&g.mode==null?g.mode="lite":h.searchParams.set("lite","true")),i&&(console.warn('Deprecation notice: The "view" option has been moved to "config.view". For headless mode use "headless: true".'),typeof g=="object"&&g.view==null&&i!=="headless"?g.view=i:h.searchParams.set("view",i)),typeof g=="string")try{new URL(g),h.searchParams.set("config",encodeURIComponent(g))}catch(s){throw new Error('"config" is not a valid URL or configuration object.')}else if(typeof g=="object")Object.keys(g).length>0&&h.searchParams.set("config","sdk");else throw new Error('"config" is not a valid URL or configuration object.');h.searchParams.set("embed","true"),h.searchParams.set("loading",m?"eager":c);let w=!1,S="Cannot call API methods after calling `destroy()`.",a=await new Promise(s=>{var C,O,R,H,j,W,B,q,N;if(!f)return;let y=f.dataset.height||f.style.height;if(y&&!m){let I=isNaN(Number(y))?y:y+"px";f.style.height=I}f.dataset.defaultStyles!=="false"&&!m&&((C=f.style).backgroundColor||(C.backgroundColor="#fff"),(O=f.style).border||(O.border="1px solid black"),(R=f.style).borderRadius||(R.borderRadius="8px"),(H=f.style).boxSizing||(H.boxSizing="border-box"),(j=f.style).padding||(j.padding="0"),(W=f.style).width||(W.width="100%"),(B=f.style).height||(B.height=f.style.height||"300px"),f.style.minHeight="200px",f.style.flexGrow="1",(q=f.style).overflow||(q.overflow="hidden"),(N=f.style).resize||(N.resize="vertical"));let L="livecodes",M=f.querySelector(`iframe.${L}`),u=M||document.createElement("iframe");u.classList.add(L),u.setAttribute("allow","accelerometer; camera; encrypted-media; display-capture; geolocation; gyroscope; microphone; midi; clipboard-read; clipboard-write; web-share"),u.setAttribute("allowtransparency","true"),u.setAttribute("allowpaymentrequest","true"),u.setAttribute("allowfullscreen","true"),u.setAttribute("sandbox","allow-same-origin allow-downloads allow-forms allow-modals allow-orientation-lock allow-pointer-lock allow-popups allow-presentation allow-scripts");let T=c==="eager"?"eager":"lazy";u.setAttribute("loading",T),m?J(u):(u.style.height="100%",u.style.minHeight="200px",u.style.width="100%",u.style.margin="0",u.style.border="0",u.style.borderRadius=f.style.borderRadius),addEventListener("message",function I(D){var Q,Z;D.source!==u.contentWindow||D.origin!==A||((Q=D.data)==null?void 0:Q.type)!=="livecodes-get-config"||(removeEventListener("message",I),(Z=u.contentWindow)==null||Z.postMessage({type:"livecodes-config",payload:g},A))}),u.onload=()=>{s(u)},u.src=h.href,M||f.appendChild(u)}),p=new Promise(s=>{addEventListener("message",function y(L){var M;L.source!==a.contentWindow||L.origin!==A||((M=L.data)==null?void 0:M.type)!=="livecodes-ready"||(removeEventListener("message",y),s(),p.settled=!0)})}),t=()=>w?Promise.reject(S):new Promise(async s=>{var L;p.settled&&s();let y={type:"livecodes-load"};(L=a.contentWindow)==null||L.postMessage(y,A),await p,s()}),e=(s,y)=>new Promise(async(L,M)=>{var T;if(w)return M(S);await t();let u=Y();addEventListener("message",function C(O){var R,H;if(!(O.source!==a.contentWindow||O.origin!==A||((R=O.data)==null?void 0:R.type)!=="livecodes-api-response"||((H=O.data)==null?void 0:H.id)!==u)&&O.data.method===s){removeEventListener("message",C);let j=O.data.payload;j!=null&&j.error?M(j.error):L(j)}}),(T=a.contentWindow)==null||T.postMessage({method:s,id:u,args:y},A)}),v={},l=["load","ready","code","console","tests","destroy"],K=(s,y)=>{var L;if(w)throw new Error(S);return l.includes(s)?(e("watch",[s]),v[s]||(v[s]=[]),(L=v[s])==null||L.push(y),{remove:()=>{var M,u;v[s]=(M=v[s])==null?void 0:M.filter(T=>T!==y),((u=v[s])==null?void 0:u.length)===0&&e("watch",[s,"unsubscribe"])}}):{remove:()=>{}}},X=s=>({"livecodes-app-loaded":"load","livecodes-ready":"ready","livecodes-change":"code","livecodes-console":"console","livecodes-test-results":"tests","livecodes-destroy":"destroy"})[s];addEventListener("message",async s=>{var M,u,T,C;let y=X((u=(M=s.data)==null?void 0:M.type)!=null?u:"");if(s.source!==a.contentWindow||s.origin!==A||!y||!v[y])return;let L=(T=s.data)==null?void 0:T.payload;(C=v[y])==null||C.forEach(O=>{O(L)})});let z=()=>{var s;Object.values(v).forEach(y=>{y.length=0}),(s=a==null?void 0:a.remove)==null||s.call(a),w=!0};c==="lazy"&&"IntersectionObserver"in window&&new IntersectionObserver((y,L)=>{y.forEach(async M=>{M.isIntersecting&&(await t(),L.unobserve(f))})},{rootMargin:"150px"}).observe(f);function J(s){s.style.position="absolute",s.style.top="0",s.style.visibility="hidden",s.style.opacity="0"}let Y=()=>(String(Math.random())+Date.now().toFixed()).replace("0.","");return{load:()=>t(),run:()=>e("run"),format:s=>e("format",[s]),getShareUrl:s=>e("getShareUrl",[s]),getConfig:s=>e("getConfig",[s]),setConfig:s=>e("setConfig",[s]),getCode:()=>e("getCode"),show:(s,y)=>e("show",[s,y]),runTests:()=>e("runTests"),onChange:s=>K("code",s),watch:K,exec:(s,...y)=>e("exec",[s,...y]),destroy:()=>p.settled?e("destroy").then(z):w?Promise.reject(S):(z(),Promise.resolve())}}function fe(d={}){let{appUrl:E,params:x,config:b,import:g,...P}=d,o=typeof b=="string"?{config:b}:b&&typeof b=="object"&&Object.keys(b).length?{x:"code/"+(0,k.compressToEncodedURIComponent)(JSON.stringify(b))}:{},n;if(x&&typeof x=="object")try{n=(0,k.compressToEncodedURIComponent)(JSON.stringify(x))}catch(r){Object.keys(x).forEach(i=>{x[i]=encodeURIComponent(String(x[i]))})}let c=new URLSearchParams(JSON.parse(JSON.stringify({...P,...n?{params:n}:x,x:g,...o}))).toString();return(E||"https://livecodes.io")+(c?"?"+c:"")}var F;globalThis.document&&document.currentScript&&"prefill"in((F=document.currentScript)==null?void 0:F.dataset)&&window.addEventListener("load",()=>{document.querySelectorAll(".livecodes").forEach(d=>{let E,x=d.dataset.options;if(x)try{E=JSON.parse(x)}catch(o){}let b,g=d.dataset.config||d.dataset.prefill;if(g)try{b=JSON.parse(g)}catch(o){}let P=encodeURIComponent(d.outerHTML);d.innerHTML="",le(d,{import:"dom/"+P,...E,...b?{config:b}:{}})})});export{le as createPlayground,fe as getPlaygroundUrl};
