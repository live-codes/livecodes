var te=Object.create;var G=Object.defineProperty;var oe=Object.getOwnPropertyDescriptor;var ne=Object.getOwnPropertyNames;var se=Object.getPrototypeOf,re=Object.prototype.hasOwnProperty;var ie=(c,g)=>()=>(g||c((g={exports:{}}).exports,g),g.exports);var ae=(c,g,L,O)=>{if(g&&typeof g=="object"||typeof g=="function")for(let v of ne(g))!re.call(c,v)&&v!==L&&G(c,v,{get:()=>g[v],enumerable:!(O=oe(g,v))||O.enumerable});return c};var le=(c,g,L)=>(L=c!=null?te(se(c)):{},ae(g||!c||!c.__esModule?G(L,"default",{value:c,enumerable:!0}):L,c));var X=ie((me,k)=>{var ce=function(){var c=String.fromCharCode,g="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",L="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",O={};function v(o,n){if(!O[o]){O[o]={};for(var i=0;i<o.length;i++)O[o][o.charAt(i)]=i}return O[o][n]}var x={compressToBase64:function(o){if(o==null)return"";var n=x._compress(o,6,function(i){return g.charAt(i)});switch(n.length%4){default:case 0:return n;case 1:return n+"===";case 2:return n+"==";case 3:return n+"="}},decompressFromBase64:function(o){return o==null?"":o==""?null:x._decompress(o.length,32,function(n){return v(g,o.charAt(n))})},compressToUTF16:function(o){return o==null?"":x._compress(o,15,function(n){return c(n+32)})+" "},decompressFromUTF16:function(o){return o==null?"":o==""?null:x._decompress(o.length,16384,function(n){return o.charCodeAt(n)-32})},compressToUint8Array:function(o){for(var n=x.compress(o),i=new Uint8Array(n.length*2),s=0,l=n.length;s<l;s++){var p=n.charCodeAt(s);i[s*2]=p>>>8,i[s*2+1]=p%256}return i},decompressFromUint8Array:function(o){if(o==null)return x.decompress(o);for(var n=new Array(o.length/2),i=0,s=n.length;i<s;i++)n[i]=o[i*2]*256+o[i*2+1];var l=[];return n.forEach(function(p){l.push(c(p))}),x.decompress(l.join(""))},compressToEncodedURIComponent:function(o){return o==null?"":x._compress(o,6,function(n){return L.charAt(n)})},decompressFromEncodedURIComponent:function(o){return o==null?"":o==""?null:(o=o.replace(/ /g,"+"),x._decompress(o.length,32,function(n){return v(L,o.charAt(n))}))},compress:function(o){return x._compress(o,16,function(n){return c(n)})},_compress:function(o,n,i){if(o==null)return"";var s,l,p={},f={},m="",S="",h="",E=2,M=3,a=2,u=[],t=0,e=0,w;for(w=0;w<o.length;w+=1)if(m=o.charAt(w),Object.prototype.hasOwnProperty.call(p,m)||(p[m]=M++,f[m]=!0),S=h+m,Object.prototype.hasOwnProperty.call(p,S))h=S;else{if(Object.prototype.hasOwnProperty.call(f,h)){if(h.charCodeAt(0)<256){for(s=0;s<a;s++)t=t<<1,e==n-1?(e=0,u.push(i(t)),t=0):e++;for(l=h.charCodeAt(0),s=0;s<8;s++)t=t<<1|l&1,e==n-1?(e=0,u.push(i(t)),t=0):e++,l=l>>1}else{for(l=1,s=0;s<a;s++)t=t<<1|l,e==n-1?(e=0,u.push(i(t)),t=0):e++,l=0;for(l=h.charCodeAt(0),s=0;s<16;s++)t=t<<1|l&1,e==n-1?(e=0,u.push(i(t)),t=0):e++,l=l>>1}E--,E==0&&(E=Math.pow(2,a),a++),delete f[h]}else for(l=p[h],s=0;s<a;s++)t=t<<1|l&1,e==n-1?(e=0,u.push(i(t)),t=0):e++,l=l>>1;E--,E==0&&(E=Math.pow(2,a),a++),p[S]=M++,h=String(m)}if(h!==""){if(Object.prototype.hasOwnProperty.call(f,h)){if(h.charCodeAt(0)<256){for(s=0;s<a;s++)t=t<<1,e==n-1?(e=0,u.push(i(t)),t=0):e++;for(l=h.charCodeAt(0),s=0;s<8;s++)t=t<<1|l&1,e==n-1?(e=0,u.push(i(t)),t=0):e++,l=l>>1}else{for(l=1,s=0;s<a;s++)t=t<<1|l,e==n-1?(e=0,u.push(i(t)),t=0):e++,l=0;for(l=h.charCodeAt(0),s=0;s<16;s++)t=t<<1|l&1,e==n-1?(e=0,u.push(i(t)),t=0):e++,l=l>>1}E--,E==0&&(E=Math.pow(2,a),a++),delete f[h]}else for(l=p[h],s=0;s<a;s++)t=t<<1|l&1,e==n-1?(e=0,u.push(i(t)),t=0):e++,l=l>>1;E--,E==0&&(E=Math.pow(2,a),a++)}for(l=2,s=0;s<a;s++)t=t<<1|l&1,e==n-1?(e=0,u.push(i(t)),t=0):e++,l=l>>1;for(;;)if(t=t<<1,e==n-1){u.push(i(t));break}else e++;return u.join("")},decompress:function(o){return o==null?"":o==""?null:x._decompress(o.length,32768,function(n){return o.charCodeAt(n)})},_decompress:function(o,n,i){var s=[],l,p=4,f=4,m=3,S="",h=[],E,M,a,u,t,e,w,d={val:i(0),position:n,index:1};for(E=0;E<3;E+=1)s[E]=E;for(a=0,t=Math.pow(2,2),e=1;e!=t;)u=d.val&d.position,d.position>>=1,d.position==0&&(d.position=n,d.val=i(d.index++)),a|=(u>0?1:0)*e,e<<=1;switch(l=a){case 0:for(a=0,t=Math.pow(2,8),e=1;e!=t;)u=d.val&d.position,d.position>>=1,d.position==0&&(d.position=n,d.val=i(d.index++)),a|=(u>0?1:0)*e,e<<=1;w=c(a);break;case 1:for(a=0,t=Math.pow(2,16),e=1;e!=t;)u=d.val&d.position,d.position>>=1,d.position==0&&(d.position=n,d.val=i(d.index++)),a|=(u>0?1:0)*e,e<<=1;w=c(a);break;case 2:return""}for(s[3]=w,M=w,h.push(w);;){if(d.index>o)return"";for(a=0,t=Math.pow(2,m),e=1;e!=t;)u=d.val&d.position,d.position>>=1,d.position==0&&(d.position=n,d.val=i(d.index++)),a|=(u>0?1:0)*e,e<<=1;switch(w=a){case 0:for(a=0,t=Math.pow(2,8),e=1;e!=t;)u=d.val&d.position,d.position>>=1,d.position==0&&(d.position=n,d.val=i(d.index++)),a|=(u>0?1:0)*e,e<<=1;s[f++]=c(a),w=f-1,p--;break;case 1:for(a=0,t=Math.pow(2,16),e=1;e!=t;)u=d.val&d.position,d.position>>=1,d.position==0&&(d.position=n,d.val=i(d.index++)),a|=(u>0?1:0)*e,e<<=1;s[f++]=c(a),w=f-1,p--;break;case 2:return h.join("")}if(p==0&&(p=Math.pow(2,m),m++),s[w])S=s[w];else if(w===f)S=M+M.charAt(0);else return null;h.push(S),s[f++]=M+S.charAt(0),p--,M=S,p==0&&(p=Math.pow(2,m),m++)}}};return x}();typeof k!="undefined"&&k!=null&&(k.exports=ce)});import{useEffect as Y,useRef as fe,useState as H}from"react";var de=le(X());async function I(c,g={}){typeof c=="object"&&!(c instanceof HTMLElement)&&c.view==="headless"&&(g=c,c=null);let{appUrl:L="https://livecodes.io/",params:O={},config:v={},import:x,headless:o,lite:n,loading:i="lazy",template:s,view:l}=g,p=o||l==="headless",f=null;if(typeof c=="string")f=document.querySelector(c);else if(c instanceof HTMLElement)f=c;else if(!(p&&typeof c=="object"))throw new Error("A valid container element is required.");if(!f)if(p)f=document.createElement("div"),z(f),document.body.appendChild(f);else throw new Error(`Cannot find element: "${c}"`);let m;try{m=new URL(L)}catch(r){throw new Error(`"${L}" is not a valid URL.`)}let S=m.origin;if(typeof O=="object"&&Object.keys(O).forEach(r=>{m.searchParams.set(r,String(O[r]))}),s&&m.searchParams.set("template",s),x&&m.searchParams.set("x",x),p&&m.searchParams.set("headless","true"),n&&(console.warn(`Deprecation notice: "lite" option is deprecated. Use "config: { mode: 'lite' }" instead.`),typeof v=="object"&&v.mode==null?v.mode="lite":m.searchParams.set("lite","true")),l&&(console.warn('Deprecation notice: The "view" option has been moved to "config.view". For headless mode use "headless: true".'),typeof v=="object"&&v.view==null&&l!=="headless"?v.view=l:m.searchParams.set("view",l)),typeof v=="string")try{new URL(v),m.searchParams.set("config",v)}catch(r){throw new Error('"config" is not a valid URL or configuration object.')}else if(typeof v=="object")Object.keys(v).length>0&&m.searchParams.set("config","sdk");else throw new Error('"config" is not a valid URL or configuration object.');m.searchParams.set("embed","true"),m.searchParams.set("loading",p?"eager":i);let h=!1,E="Cannot call API methods after calling `destroy()`.",a=await new Promise(r=>{var U,C,j,_,R,W,B,q,Z;if(!f)return;let b=f.dataset.height||f.style.height;if(b&&!p){let D=isNaN(Number(b))?b:b+"px";f.style.height=D}f.dataset.defaultStyles!=="false"&&!p&&((U=f.style).backgroundColor||(U.backgroundColor="#fff"),(C=f.style).border||(C.border="1px solid black"),(j=f.style).borderRadius||(j.borderRadius="8px"),(_=f.style).boxSizing||(_.boxSizing="border-box"),(R=f.style).padding||(R.padding="0"),(W=f.style).width||(W.width="100%"),(B=f.style).height||(B.height=f.style.height||"300px"),f.style.minHeight="200px",f.style.flexGrow="1",(q=f.style).overflow||(q.overflow="hidden"),(Z=f.style).resize||(Z.resize="vertical"));let P="livecodes",A=f.querySelector(`iframe.${P}`),y=A||document.createElement("iframe");y.classList.add(P),y.setAttribute("allow","accelerometer; camera; encrypted-media; display-capture; geolocation; gyroscope; microphone; midi; clipboard-read; clipboard-write; web-share"),y.setAttribute("allowtransparency","true"),y.setAttribute("allowpaymentrequest","true"),y.setAttribute("allowfullscreen","true"),y.setAttribute("sandbox","allow-same-origin allow-downloads allow-forms allow-modals allow-orientation-lock allow-pointer-lock allow-popups allow-presentation allow-scripts");let T=i==="eager"?"eager":"lazy";y.setAttribute("loading",T),p?z(y):(y.style.height="100%",y.style.minHeight="200px",y.style.width="100%",y.style.margin="0",y.style.border="0",y.style.borderRadius=f.style.borderRadius),addEventListener("message",function D(N){var Q,$;N.source!==y.contentWindow||N.origin!==S||((Q=N.data)==null?void 0:Q.type)!=="livecodes-get-config"||(removeEventListener("message",D),($=y.contentWindow)==null||$.postMessage({type:"livecodes-config",payload:v},S))}),y.onload=()=>{r(y)},y.src=m.href,A||f.appendChild(y)}),u=new Promise(r=>{addEventListener("message",function b(P){var A;P.source!==a.contentWindow||P.origin!==S||((A=P.data)==null?void 0:A.type)!=="livecodes-ready"||(removeEventListener("message",b),r(),u.settled=!0)})}),t=()=>h?Promise.reject(E):new Promise(async r=>{var P;u.settled&&r();let b={type:"livecodes-load"};(P=a.contentWindow)==null||P.postMessage(b,S),await u,r()}),e=(r,b)=>new Promise(async(P,A)=>{var T;if(h)return A(E);await t();let y=ee();addEventListener("message",function U(C){var j,_;if(!(C.source!==a.contentWindow||C.origin!==S||((j=C.data)==null?void 0:j.type)!=="livecodes-api-response"||((_=C.data)==null?void 0:_.id)!==y)&&C.data.method===r){removeEventListener("message",U);let R=C.data.payload;R!=null&&R.error?A(R.error):P(R)}}),(T=a.contentWindow)==null||T.postMessage({method:r,id:y,args:b},S)}),w={},d=["load","ready","code","console","tests","destroy"],J=(r,b)=>{var P;if(h)throw new Error(E);return d.includes(r)?(e("watch",[r]),w[r]||(w[r]=[]),(P=w[r])==null||P.push(b),{remove:()=>{var A,y;w[r]=(A=w[r])==null?void 0:A.filter(T=>T!==b),((y=w[r])==null?void 0:y.length)===0&&e("watch",[r,"unsubscribe"])}}):{remove:()=>{}}},V=r=>({"livecodes-app-loaded":"load","livecodes-ready":"ready","livecodes-change":"code","livecodes-console":"console","livecodes-test-results":"tests","livecodes-destroy":"destroy"})[r];addEventListener("message",async r=>{var A,y,T,U;let b=V((y=(A=r.data)==null?void 0:A.type)!=null?y:"");if(r.source!==a.contentWindow||r.origin!==S||!b||!w[b])return;let P=(T=r.data)==null?void 0:T.payload;(U=w[b])==null||U.forEach(C=>{C(P)})});let K=()=>{var r;Object.values(w).forEach(b=>{b.length=0}),(r=a==null?void 0:a.remove)==null||r.call(a),h=!0};i==="lazy"&&"IntersectionObserver"in window&&new IntersectionObserver((b,P)=>{b.forEach(async A=>{A.isIntersecting&&(await t(),P.unobserve(f))})},{rootMargin:"150px"}).observe(f);function z(r){r.style.position="absolute",r.style.top="0",r.style.visibility="hidden",r.style.opacity="0"}let ee=()=>(String(Math.random())+Date.now().toFixed()).replace("0.","");return{load:()=>t(),run:()=>e("run"),format:r=>e("format",[r]),getShareUrl:r=>e("getShareUrl",[r]),getConfig:r=>e("getConfig",[r]),setConfig:r=>e("setConfig",[r]),getCode:()=>e("getCode"),show:(r,b)=>e("show",[r,b]),runTests:()=>e("runTests"),onChange:r=>J("code",r),watch:J,exec:(r,...b)=>e("exec",[r,...b]),destroy:()=>u.settled?e("destroy").then(K):h?Promise.reject(E):(K(),Promise.resolve())}}var F;globalThis.document&&document.currentScript&&"prefill"in((F=document.currentScript)==null?void 0:F.dataset)&&window.addEventListener("load",()=>{document.querySelectorAll(".livecodes").forEach(c=>{let g,L=c.dataset.options;if(L)try{g=JSON.parse(L)}catch(o){}let O,v=c.dataset.config||c.dataset.prefill;if(v)try{O=JSON.parse(v)}catch(o){}let x=encodeURIComponent(c.outerHTML);c.innerHTML="",I(c,{import:"dom/"+x,...g,...O?{config:O}:{}})})});import{jsx as pe}from"react/jsx-runtime";function ue(c){let g=fe(null),[L,O]=H(c.className||""),[v,x]=H(c.style||{}),[o,n]=H(c.height),[i,s]=H(),[l,p]=H(JSON.stringify(c.config||"")),[f,m]=H("");return Y(()=>{if(!g.current)return;let{className:S,style:h,height:E,sdkReady:M,config:a,...u}=c;if(O(S||""),x(h||{}),n(E),!i||f!==JSON.stringify(u))m(JSON.stringify(u)),i==null||i.destroy(),I(g.current,{config:a,...u}).then(t=>{s(t),typeof M=="function"&&M(t)});else{if(l===JSON.stringify(a))return;p(JSON.stringify(a)),typeof a=="string"?fetch(a).then(t=>t.json()).then(t=>{i==null||i.setConfig(t)}):a&&i.setConfig(a)}},[c]),Y(()=>()=>{i==null||i.destroy()},[]),pe("div",{ref:g,className:L,style:v,"data-height":o})}export{ue as default};
