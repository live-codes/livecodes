var oe=Object.create;var G=Object.defineProperty;var ne=Object.getOwnPropertyDescriptor;var se=Object.getOwnPropertyNames;var re=Object.getPrototypeOf,ie=Object.prototype.hasOwnProperty;var ae=(l,v)=>()=>(v||l((v={exports:{}}).exports,v),v.exports);var ce=(l,v,A,P)=>{if(v&&typeof v=="object"||typeof v=="function")for(let w of se(v))!ie.call(l,w)&&w!==A&&G(l,w,{get:()=>v[w],enumerable:!(P=ne(v,w))||P.enumerable});return l};var le=(l,v,A)=>(A=l!=null?oe(re(l)):{},ce(v||!l||!l.__esModule?G(A,"default",{value:l,enumerable:!0}):A,l));var F=ae((me,_)=>{var de=function(){var l=String.fromCharCode,v="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",A="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",P={};function w(o,n){if(!P[o]){P[o]={};for(var r=0;r<o.length;r++)P[o][o.charAt(r)]=r}return P[o][n]}var O={compressToBase64:function(o){if(o==null)return"";var n=O._compress(o,6,function(r){return v.charAt(r)});switch(n.length%4){default:case 0:return n;case 1:return n+"===";case 2:return n+"==";case 3:return n+"="}},decompressFromBase64:function(o){return o==null?"":o==""?null:O._decompress(o.length,32,function(n){return w(v,o.charAt(n))})},compressToUTF16:function(o){return o==null?"":O._compress(o,15,function(n){return l(n+32)})+" "},decompressFromUTF16:function(o){return o==null?"":o==""?null:O._decompress(o.length,16384,function(n){return o.charCodeAt(n)-32})},compressToUint8Array:function(o){for(var n=O.compress(o),r=new Uint8Array(n.length*2),s=0,c=n.length;s<c;s++){var p=n.charCodeAt(s);r[s*2]=p>>>8,r[s*2+1]=p%256}return r},decompressFromUint8Array:function(o){if(o==null)return O.decompress(o);for(var n=new Array(o.length/2),r=0,s=n.length;r<s;r++)n[r]=o[r*2]*256+o[r*2+1];var c=[];return n.forEach(function(p){c.push(l(p))}),O.decompress(c.join(""))},compressToEncodedURIComponent:function(o){return o==null?"":O._compress(o,6,function(n){return A.charAt(n)})},decompressFromEncodedURIComponent:function(o){return o==null?"":o==""?null:(o=o.replace(/ /g,"+"),O._decompress(o.length,32,function(n){return w(A,o.charAt(n))}))},compress:function(o){return O._compress(o,16,function(n){return l(n)})},_compress:function(o,n,r){if(o==null)return"";var s,c,p={},f={},y="",S="",h="",b=2,M=3,i=2,u=[],t=0,e=0,E;for(E=0;E<o.length;E+=1)if(y=o.charAt(E),Object.prototype.hasOwnProperty.call(p,y)||(p[y]=M++,f[y]=!0),S=h+y,Object.prototype.hasOwnProperty.call(p,S))h=S;else{if(Object.prototype.hasOwnProperty.call(f,h)){if(h.charCodeAt(0)<256){for(s=0;s<i;s++)t=t<<1,e==n-1?(e=0,u.push(r(t)),t=0):e++;for(c=h.charCodeAt(0),s=0;s<8;s++)t=t<<1|c&1,e==n-1?(e=0,u.push(r(t)),t=0):e++,c=c>>1}else{for(c=1,s=0;s<i;s++)t=t<<1|c,e==n-1?(e=0,u.push(r(t)),t=0):e++,c=0;for(c=h.charCodeAt(0),s=0;s<16;s++)t=t<<1|c&1,e==n-1?(e=0,u.push(r(t)),t=0):e++,c=c>>1}b--,b==0&&(b=Math.pow(2,i),i++),delete f[h]}else for(c=p[h],s=0;s<i;s++)t=t<<1|c&1,e==n-1?(e=0,u.push(r(t)),t=0):e++,c=c>>1;b--,b==0&&(b=Math.pow(2,i),i++),p[S]=M++,h=String(y)}if(h!==""){if(Object.prototype.hasOwnProperty.call(f,h)){if(h.charCodeAt(0)<256){for(s=0;s<i;s++)t=t<<1,e==n-1?(e=0,u.push(r(t)),t=0):e++;for(c=h.charCodeAt(0),s=0;s<8;s++)t=t<<1|c&1,e==n-1?(e=0,u.push(r(t)),t=0):e++,c=c>>1}else{for(c=1,s=0;s<i;s++)t=t<<1|c,e==n-1?(e=0,u.push(r(t)),t=0):e++,c=0;for(c=h.charCodeAt(0),s=0;s<16;s++)t=t<<1|c&1,e==n-1?(e=0,u.push(r(t)),t=0):e++,c=c>>1}b--,b==0&&(b=Math.pow(2,i),i++),delete f[h]}else for(c=p[h],s=0;s<i;s++)t=t<<1|c&1,e==n-1?(e=0,u.push(r(t)),t=0):e++,c=c>>1;b--,b==0&&(b=Math.pow(2,i),i++)}for(c=2,s=0;s<i;s++)t=t<<1|c&1,e==n-1?(e=0,u.push(r(t)),t=0):e++,c=c>>1;for(;;)if(t=t<<1,e==n-1){u.push(r(t));break}else e++;return u.join("")},decompress:function(o){return o==null?"":o==""?null:O._decompress(o.length,32768,function(n){return o.charCodeAt(n)})},_decompress:function(o,n,r){var s=[],c,p=4,f=4,y=3,S="",h=[],b,M,i,u,t,e,E,d={val:r(0),position:n,index:1};for(b=0;b<3;b+=1)s[b]=b;for(i=0,t=Math.pow(2,2),e=1;e!=t;)u=d.val&d.position,d.position>>=1,d.position==0&&(d.position=n,d.val=r(d.index++)),i|=(u>0?1:0)*e,e<<=1;switch(c=i){case 0:for(i=0,t=Math.pow(2,8),e=1;e!=t;)u=d.val&d.position,d.position>>=1,d.position==0&&(d.position=n,d.val=r(d.index++)),i|=(u>0?1:0)*e,e<<=1;E=l(i);break;case 1:for(i=0,t=Math.pow(2,16),e=1;e!=t;)u=d.val&d.position,d.position>>=1,d.position==0&&(d.position=n,d.val=r(d.index++)),i|=(u>0?1:0)*e,e<<=1;E=l(i);break;case 2:return""}for(s[3]=E,M=E,h.push(E);;){if(d.index>o)return"";for(i=0,t=Math.pow(2,y),e=1;e!=t;)u=d.val&d.position,d.position>>=1,d.position==0&&(d.position=n,d.val=r(d.index++)),i|=(u>0?1:0)*e,e<<=1;switch(E=i){case 0:for(i=0,t=Math.pow(2,8),e=1;e!=t;)u=d.val&d.position,d.position>>=1,d.position==0&&(d.position=n,d.val=r(d.index++)),i|=(u>0?1:0)*e,e<<=1;s[f++]=l(i),E=f-1,p--;break;case 1:for(i=0,t=Math.pow(2,16),e=1;e!=t;)u=d.val&d.position,d.position>>=1,d.position==0&&(d.position=n,d.val=r(d.index++)),i|=(u>0?1:0)*e,e<<=1;s[f++]=l(i),E=f-1,p--;break;case 2:return h.join("")}if(p==0&&(p=Math.pow(2,y),y++),s[E])S=s[E];else if(E===f)S=M+M.charAt(0);else return null;h.push(S),s[f++]=M+S.charAt(0),p--,M=S,p==0&&(p=Math.pow(2,y),y++)}}};return O}();typeof _!="undefined"&&_!=null&&(_.exports=de)});import{useEffect as V,useRef as fe,useState as j}from"react";var Y=le(F());async function D(l,v={}){typeof l=="object"&&!(l instanceof HTMLElement)&&l.view==="headless"&&(v=l,l=null);let{appUrl:A="https://livecodes.io/",params:P={},config:w={},import:O,headless:o,lite:n,loading:r="lazy",template:s,view:c}=v,p=o||c==="headless",f=null;if(typeof l=="string")f=document.querySelector(l);else if(l instanceof HTMLElement)f=l;else if(!(p&&typeof l=="object"))throw new Error("A valid container element is required.");if(!f)if(p)f=document.createElement("div"),z(f),document.body.appendChild(f);else throw new Error(`Cannot find element: "${l}"`);let y;try{y=new URL(A)}catch(a){throw new Error(`"${A}" is not a valid URL.`)}let S=y.origin;if(P&&typeof P=="object")try{y.searchParams.set("params",(0,Y.compressToEncodedURIComponent)(JSON.stringify(P)))}catch(a){Object.keys(P).forEach(g=>{y.searchParams.set(g,encodeURIComponent(String(P[g])))})}if(s&&y.searchParams.set("template",s),O&&y.searchParams.set("x",encodeURIComponent(O)),p&&y.searchParams.set("headless","true"),n&&(console.warn(`Deprecation notice: "lite" option is deprecated. Use "config: { mode: 'lite' }" instead.`),typeof w=="object"&&w.mode==null?w.mode="lite":y.searchParams.set("lite","true")),c&&(console.warn('Deprecation notice: The "view" option has been moved to "config.view". For headless mode use "headless: true".'),typeof w=="object"&&w.view==null&&c!=="headless"?w.view=c:y.searchParams.set("view",c)),typeof w=="string")try{new URL(w),y.searchParams.set("config",encodeURIComponent(w))}catch(a){throw new Error('"config" is not a valid URL or configuration object.')}else if(typeof w=="object")Object.keys(w).length>0&&y.searchParams.set("config","sdk");else throw new Error('"config" is not a valid URL or configuration object.');y.searchParams.set("embed","true"),y.searchParams.set("loading",p?"eager":r);let h=!1,b="Cannot call API methods after calling `destroy()`.",i=await new Promise(a=>{var T,C,H,k,U,W,B,q,Q;if(!f)return;let g=f.dataset.height||f.style.height;if(g&&!p){let I=isNaN(Number(g))?g:g+"px";f.style.height=I}f.dataset.defaultStyles!=="false"&&!p&&((T=f.style).backgroundColor||(T.backgroundColor="#fff"),(C=f.style).border||(C.border="1px solid black"),(H=f.style).borderRadius||(H.borderRadius="8px"),(k=f.style).boxSizing||(k.boxSizing="border-box"),(U=f.style).padding||(U.padding="0"),(W=f.style).width||(W.width="100%"),(B=f.style).height||(B.height=f.style.height||"300px"),f.style.minHeight="200px",f.style.flexGrow="1",(q=f.style).overflow||(q.overflow="hidden"),(Q=f.style).resize||(Q.resize="vertical"));let x="livecodes",L=f.querySelector(`iframe.${x}`),m=L||document.createElement("iframe");m.classList.add(x),m.setAttribute("allow","accelerometer; camera; encrypted-media; display-capture; geolocation; gyroscope; microphone; midi; clipboard-read; clipboard-write; web-share"),m.setAttribute("allowtransparency","true"),m.setAttribute("allowpaymentrequest","true"),m.setAttribute("allowfullscreen","true"),m.setAttribute("sandbox","allow-same-origin allow-downloads allow-forms allow-modals allow-orientation-lock allow-pointer-lock allow-popups allow-presentation allow-scripts");let R=r==="eager"?"eager":"lazy";m.setAttribute("loading",R),p?z(m):(m.style.height="100%",m.style.minHeight="200px",m.style.width="100%",m.style.margin="0",m.style.border="0",m.style.borderRadius=f.style.borderRadius),addEventListener("message",function I(N){var Z,$;N.source!==m.contentWindow||N.origin!==S||((Z=N.data)==null?void 0:Z.type)!=="livecodes-get-config"||(removeEventListener("message",I),($=m.contentWindow)==null||$.postMessage({type:"livecodes-config",payload:w},S))}),m.onload=()=>{a(m)},m.src=y.href,L||f.appendChild(m)}),u=new Promise(a=>{addEventListener("message",function g(x){var L;x.source!==i.contentWindow||x.origin!==S||((L=x.data)==null?void 0:L.type)!=="livecodes-ready"||(removeEventListener("message",g),a(),u.settled=!0)})}),t=()=>h?Promise.reject(b):new Promise(async a=>{var x;u.settled&&a();let g={type:"livecodes-load"};(x=i.contentWindow)==null||x.postMessage(g,S),await u,a()}),e=(a,g)=>new Promise(async(x,L)=>{var R;if(h)return L(b);await t();let m=te();addEventListener("message",function T(C){var H,k;if(!(C.source!==i.contentWindow||C.origin!==S||((H=C.data)==null?void 0:H.type)!=="livecodes-api-response"||((k=C.data)==null?void 0:k.id)!==m)&&C.data.method===a){removeEventListener("message",T);let U=C.data.payload;U!=null&&U.error?L(U.error):x(U)}}),(R=i.contentWindow)==null||R.postMessage({method:a,id:m,args:g},S)}),E={},d=["load","ready","code","console","tests","destroy"],J=(a,g)=>{var x;if(h)throw new Error(b);return d.includes(a)?(e("watch",[a]),E[a]||(E[a]=[]),(x=E[a])==null||x.push(g),{remove:()=>{var L,m;E[a]=(L=E[a])==null?void 0:L.filter(R=>R!==g),((m=E[a])==null?void 0:m.length)===0&&e("watch",[a,"unsubscribe"])}}):{remove:()=>{}}},ee=a=>({"livecodes-app-loaded":"load","livecodes-ready":"ready","livecodes-change":"code","livecodes-console":"console","livecodes-test-results":"tests","livecodes-destroy":"destroy"})[a];addEventListener("message",async a=>{var L,m,R,T;let g=ee((m=(L=a.data)==null?void 0:L.type)!=null?m:"");if(a.source!==i.contentWindow||a.origin!==S||!g||!E[g])return;let x=(R=a.data)==null?void 0:R.payload;(T=E[g])==null||T.forEach(C=>{C(x)})});let K=()=>{var a;Object.values(E).forEach(g=>{g.length=0}),(a=i==null?void 0:i.remove)==null||a.call(i),h=!0};r==="lazy"&&"IntersectionObserver"in window&&new IntersectionObserver((g,x)=>{g.forEach(async L=>{L.isIntersecting&&(await t(),x.unobserve(f))})},{rootMargin:"150px"}).observe(f);function z(a){a.style.position="absolute",a.style.top="0",a.style.visibility="hidden",a.style.opacity="0"}let te=()=>(String(Math.random())+Date.now().toFixed()).replace("0.","");return{load:()=>t(),run:()=>e("run"),format:a=>e("format",[a]),getShareUrl:a=>e("getShareUrl",[a]),getConfig:a=>e("getConfig",[a]),setConfig:a=>e("setConfig",[a]),getCode:()=>e("getCode"),show:(a,g)=>e("show",[a,g]),runTests:()=>e("runTests"),onChange:a=>J("code",a),watch:J,exec:(a,...g)=>e("exec",[a,...g]),destroy:()=>u.settled?e("destroy").then(K):h?Promise.reject(b):(K(),Promise.resolve())}}var X;globalThis.document&&document.currentScript&&"prefill"in((X=document.currentScript)==null?void 0:X.dataset)&&window.addEventListener("load",()=>{document.querySelectorAll(".livecodes").forEach(l=>{let v,A=l.dataset.options;if(A)try{v=JSON.parse(A)}catch(o){}let P,w=l.dataset.config||l.dataset.prefill;if(w)try{P=JSON.parse(w)}catch(o){}let O=encodeURIComponent(l.outerHTML);l.innerHTML="",D(l,{import:"dom/"+O,...v,...P?{config:P}:{}})})});import{jsx as pe}from"react/jsx-runtime";function ue(l){let v=fe(null),[A,P]=j(l.className||""),[w,O]=j(l.style||{}),[o,n]=j(l.height),[r,s]=j(),[c,p]=j(JSON.stringify(l.config||"")),[f,y]=j("");return V(()=>{if(!v.current)return;let{className:S,style:h,height:b,sdkReady:M,config:i,...u}=l;if(P(S||""),O(h||{}),n(b),!r||f!==JSON.stringify(u))y(JSON.stringify(u)),r==null||r.destroy(),D(v.current,{config:i,...u}).then(t=>{s(t),typeof M=="function"&&M(t)});else{if(c===JSON.stringify(i))return;p(JSON.stringify(i)),typeof i=="string"?fetch(i).then(t=>t.json()).then(t=>{r==null||r.setConfig(t)}):i&&r.setConfig(i)}},[l]),V(()=>()=>{r==null||r.destroy()},[]),pe("div",{ref:v,className:A,style:w,"data-height":o})}export{ue as default};
