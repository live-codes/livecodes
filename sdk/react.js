var te=Object.create;var $=Object.defineProperty;var ne=Object.getOwnPropertyDescriptor;var oe=Object.getOwnPropertyNames;var se=Object.getPrototypeOf,re=Object.prototype.hasOwnProperty;var ie=(d,m)=>()=>(m||d((m={exports:{}}).exports,m),m.exports);var ae=(d,m,b,u)=>{if(m&&typeof m=="object"||typeof m=="function")for(let A of oe(m))!re.call(d,A)&&A!==b&&$(d,A,{get:()=>m[A],enumerable:!(u=ne(m,A))||u.enumerable});return d};var le=(d,m,b)=>(b=d!=null?te(se(d)):{},ae(m||!d||!d.__esModule?$(b,"default",{value:d,enumerable:!0}):b,d));var G=ie((ye,J)=>{var ce=function(){var d=String.fromCharCode,m="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",u={};function A(s,e){if(!u[s]){u[s]={};for(var i=0;i<s.length;i++)u[s][s.charAt(i)]=i}return u[s][e]}var O={compressToBase64:function(s){if(s==null)return"";var e=O._compress(s,6,function(i){return m.charAt(i)});switch(e.length%4){default:case 0:return e;case 1:return e+"===";case 2:return e+"==";case 3:return e+"="}},decompressFromBase64:function(s){return s==null?"":s==""?null:O._decompress(s.length,32,function(e){return A(m,s.charAt(e))})},compressToUTF16:function(s){return s==null?"":O._compress(s,15,function(e){return d(e+32)})+" "},decompressFromUTF16:function(s){return s==null?"":s==""?null:O._decompress(s.length,16384,function(e){return s.charCodeAt(e)-32})},compressToUint8Array:function(s){for(var e=O.compress(s),i=new Uint8Array(e.length*2),n=0,r=e.length;n<r;n++){var y=e.charCodeAt(n);i[n*2]=y>>>8,i[n*2+1]=y%256}return i},decompressFromUint8Array:function(s){if(s==null)return O.decompress(s);for(var e=new Array(s.length/2),i=0,n=e.length;i<n;i++)e[i]=s[i*2]*256+s[i*2+1];var r=[];return e.forEach(function(y){r.push(d(y))}),O.decompress(r.join(""))},compressToEncodedURIComponent:function(s){return s==null?"":O._compress(s,6,function(e){return b.charAt(e)})},decompressFromEncodedURIComponent:function(s){return s==null?"":s==""?null:(s=s.replace(/ /g,"+"),O._decompress(s.length,32,function(e){return A(b,s.charAt(e))}))},compress:function(s){return O._compress(s,16,function(e){return d(e)})},_compress:function(s,e,i){if(s==null)return"";var n,r,y={},v={},w="",M="",g="",S=2,E=3,l=2,f=[],t=0,o=0,x;for(x=0;x<s.length;x+=1)if(w=s.charAt(x),Object.prototype.hasOwnProperty.call(y,w)||(y[w]=E++,v[w]=!0),M=g+w,Object.prototype.hasOwnProperty.call(y,M))g=M;else{if(Object.prototype.hasOwnProperty.call(v,g)){if(g.charCodeAt(0)<256){for(n=0;n<l;n++)t=t<<1,o==e-1?(o=0,f.push(i(t)),t=0):o++;for(r=g.charCodeAt(0),n=0;n<8;n++)t=t<<1|r&1,o==e-1?(o=0,f.push(i(t)),t=0):o++,r=r>>1}else{for(r=1,n=0;n<l;n++)t=t<<1|r,o==e-1?(o=0,f.push(i(t)),t=0):o++,r=0;for(r=g.charCodeAt(0),n=0;n<16;n++)t=t<<1|r&1,o==e-1?(o=0,f.push(i(t)),t=0):o++,r=r>>1}S--,S==0&&(S=Math.pow(2,l),l++),delete v[g]}else for(r=y[g],n=0;n<l;n++)t=t<<1|r&1,o==e-1?(o=0,f.push(i(t)),t=0):o++,r=r>>1;S--,S==0&&(S=Math.pow(2,l),l++),y[M]=E++,g=String(w)}if(g!==""){if(Object.prototype.hasOwnProperty.call(v,g)){if(g.charCodeAt(0)<256){for(n=0;n<l;n++)t=t<<1,o==e-1?(o=0,f.push(i(t)),t=0):o++;for(r=g.charCodeAt(0),n=0;n<8;n++)t=t<<1|r&1,o==e-1?(o=0,f.push(i(t)),t=0):o++,r=r>>1}else{for(r=1,n=0;n<l;n++)t=t<<1|r,o==e-1?(o=0,f.push(i(t)),t=0):o++,r=0;for(r=g.charCodeAt(0),n=0;n<16;n++)t=t<<1|r&1,o==e-1?(o=0,f.push(i(t)),t=0):o++,r=r>>1}S--,S==0&&(S=Math.pow(2,l),l++),delete v[g]}else for(r=y[g],n=0;n<l;n++)t=t<<1|r&1,o==e-1?(o=0,f.push(i(t)),t=0):o++,r=r>>1;S--,S==0&&(S=Math.pow(2,l),l++)}for(r=2,n=0;n<l;n++)t=t<<1|r&1,o==e-1?(o=0,f.push(i(t)),t=0):o++,r=r>>1;for(;;)if(t=t<<1,o==e-1){f.push(i(t));break}else o++;return f.join("")},decompress:function(s){return s==null?"":s==""?null:O._decompress(s.length,32768,function(e){return s.charCodeAt(e)})},_decompress:function(s,e,i){var n=[],r,y=4,v=4,w=3,M="",g=[],S,E,l,f,t,o,x,c={val:i(0),position:e,index:1};for(S=0;S<3;S+=1)n[S]=S;for(l=0,t=Math.pow(2,2),o=1;o!=t;)f=c.val&c.position,c.position>>=1,c.position==0&&(c.position=e,c.val=i(c.index++)),l|=(f>0?1:0)*o,o<<=1;switch(r=l){case 0:for(l=0,t=Math.pow(2,8),o=1;o!=t;)f=c.val&c.position,c.position>>=1,c.position==0&&(c.position=e,c.val=i(c.index++)),l|=(f>0?1:0)*o,o<<=1;x=d(l);break;case 1:for(l=0,t=Math.pow(2,16),o=1;o!=t;)f=c.val&c.position,c.position>>=1,c.position==0&&(c.position=e,c.val=i(c.index++)),l|=(f>0?1:0)*o,o<<=1;x=d(l);break;case 2:return""}for(n[3]=x,E=x,g.push(x);;){if(c.index>s)return"";for(l=0,t=Math.pow(2,w),o=1;o!=t;)f=c.val&c.position,c.position>>=1,c.position==0&&(c.position=e,c.val=i(c.index++)),l|=(f>0?1:0)*o,o<<=1;switch(x=l){case 0:for(l=0,t=Math.pow(2,8),o=1;o!=t;)f=c.val&c.position,c.position>>=1,c.position==0&&(c.position=e,c.val=i(c.index++)),l|=(f>0?1:0)*o,o<<=1;n[v++]=d(l),x=v-1,y--;break;case 1:for(l=0,t=Math.pow(2,16),o=1;o!=t;)f=c.val&c.position,c.position>>=1,c.position==0&&(c.position=e,c.val=i(c.index++)),l|=(f>0?1:0)*o,o<<=1;n[v++]=d(l),x=v-1,y--;break;case 2:return g.join("")}if(y==0&&(y=Math.pow(2,w),w++),n[x])M=n[x];else if(x===v)M=E+E.charAt(0);else return null;g.push(M),n[v++]=E+M.charAt(0),y--,E=M,y==0&&(y=Math.pow(2,w),w++)}}};return O}();typeof J!="undefined"&&J!=null&&(J.exports=ce)});import{useEffect as Y,useRef as fe,useState as k}from"react";var K=le(G());async function X(d,m={}){typeof d=="object"&&!(d instanceof HTMLElement)&&(d.headless||d.view==="headless")&&(m=d,d=null);let{config:b={},headless:u,loading:A="lazy",view:O}=m,s=u||O==="headless",e=null,i=null;if(typeof d=="string")e=document.querySelector(d);else if(d instanceof HTMLElement)e=d;else if(!(s&&typeof d=="object"))throw new Error("A valid container element is required.");if(!e)if(s)e=document.createElement("div"),W(e),document.body.appendChild(e);else throw new Error(`Cannot find element: "${d}"`);let n=new URL(de(m)),r=n.origin;n.searchParams.set("embed","true"),n.searchParams.set("loading",s?"eager":A),n.searchParams.set("sdkVersion","0.12.0"),typeof b=="object"&&Object.keys(b).length>0&&n.searchParams.set("config","sdk");let y=m.params;typeof y=="object"&&Object.keys(y).length>0&&JSON.stringify(y).length<1800&&Object.keys(y).forEach(a=>{n.searchParams.set(a,encodeURIComponent(String(y[a])))});let v=!1,w="Cannot call API methods after calling `destroy()`.",M=[],g=(a,p="message")=>{addEventListener(p,a),M.push(a)},E=await new Promise(a=>{var j,C,T,I,U,z,B,q,Q;if(!e)return;let p=e.dataset.height||e.style.height;if(p&&!s){let _=isNaN(Number(p))?p:p+"px";e.style.height=_}e.dataset.defaultStyles!=="false"&&!s&&((j=e.style).backgroundColor||(j.backgroundColor="#fff"),(C=e.style).border||(C.border="1px solid black"),(T=e.style).borderRadius||(T.borderRadius="8px"),(I=e.style).boxSizing||(I.boxSizing="border-box"),(U=e.style).padding||(U.padding="0"),(z=e.style).width||(z.width="100%"),(B=e.style).height||(B.height=e.style.height||"300px"),e.style.minHeight="200px",e.style.flexGrow="1",(q=e.style).overflow||(q.overflow="hidden"),(Q=e.style).resize||(Q.resize="vertical"));let P="livecodes",L=e.querySelector(`iframe.${P}`),h=L||document.createElement("iframe");h.classList.add(P),h.setAttribute("allow","accelerometer; camera; encrypted-media; display-capture; geolocation; gyroscope; microphone; midi; clipboard-read; clipboard-write; web-share"),h.setAttribute("allowtransparency","true"),h.setAttribute("allowpaymentrequest","true"),h.setAttribute("allowfullscreen","true"),h.setAttribute("sandbox","allow-same-origin allow-downloads allow-forms allow-modals allow-orientation-lock allow-pointer-lock allow-popups allow-presentation allow-scripts");let R=A==="eager"?"eager":"lazy";h.setAttribute("loading",R),s?W(h):(h.style.height="100%",h.style.minHeight="200px",h.style.width="100%",h.style.margin="0",h.style.border="0",h.style.borderRadius=e.style.borderRadius),g(function _(H){var D;H.source!==h.contentWindow||H.origin!==r||((D=H.data)==null?void 0:D.type)!=="livecodes-init"||(removeEventListener("message",_),i=Number(H.data.payload.appVersion.replace(/^v/,"")))}),(!i||i<46)&&g(function _(H){var D,Z;H.source!==h.contentWindow||H.origin!==r||((D=H.data)==null?void 0:D.type)!=="livecodes-get-config"||(removeEventListener("message",_),(Z=h.contentWindow)==null||Z.postMessage({type:"livecodes-config",payload:b},r))}),h.onload=()=>{a(h)},h.src=n.href,L||e.appendChild(h)}),l=new Promise(a=>{g(function p(P){var L;P.source!==E.contentWindow||P.origin!==r||((L=P.data)==null?void 0:L.type)!=="livecodes-ready"||(removeEventListener("message",p),a(),l.settled=!0)})}),f=()=>v?Promise.reject(w):new Promise(async a=>{var P;l.settled&&a();let p={type:"livecodes-load"};(P=E.contentWindow)==null||P.postMessage(p,r),await l,a()}),t=(a,p)=>new Promise(async(P,L)=>{var R;if(v)return L(w);await f();let h=ee();g(function j(C){var T,I;if(!(C.source!==E.contentWindow||C.origin!==r||((T=C.data)==null?void 0:T.type)!=="livecodes-api-response"||((I=C.data)==null?void 0:I.id)!==h)&&C.data.method===a){removeEventListener("message",j);let U=C.data.payload;U!=null&&U.error?L(U.error):P(U)}}),(R=E.contentWindow)==null||R.postMessage({method:a,id:h,args:p},r)}),o={},x=["load","ready","code","console","tests","destroy"],c=(a,p)=>{var P;if(v)throw new Error(w);return x.includes(a)?(t("watch",[a]),o[a]||(o[a]=[]),(P=o[a])==null||P.push(p),{remove:()=>{var L,h;o[a]=(L=o[a])==null?void 0:L.filter(R=>R!==p),((h=o[a])==null?void 0:h.length)===0&&t("watch",[a,"unsubscribe"])}}):{remove:()=>{}}},F=a=>({"livecodes-app-loaded":"load","livecodes-ready":"ready","livecodes-change":"code","livecodes-console":"console","livecodes-test-results":"tests","livecodes-destroy":"destroy"})[a];g(async function(p){var h,R,j,C;let P=F((R=(h=p.data)==null?void 0:h.type)!=null?R:"");if(p.source!==E.contentWindow||p.origin!==r||!P||!o[P])return;let L=(j=p.data)==null?void 0:j.payload;(C=o[P])==null||C.forEach(T=>{T(L)})});let V=()=>{var a;(a=E==null?void 0:E.remove)==null||a.call(E),Object.values(o).forEach(p=>{p.length=0}),M.forEach(p=>removeEventListener("message",p)),M.length=0,N&&e&&N.unobserve(e),v=!0},N;A==="lazy"&&"IntersectionObserver"in window&&(N=new IntersectionObserver((a,p)=>{a.forEach(async P=>{P.isIntersecting&&(await f(),p.unobserve(e))})},{rootMargin:"150px"}),N.observe(e));function W(a){a.style.position="absolute",a.style.top="0",a.style.visibility="hidden",a.style.opacity="0"}let ee=()=>(String(Math.random())+Date.now().toFixed()).replace("0.","");return{load:()=>f(),run:()=>t("run"),format:a=>t("format",[a]),getShareUrl:a=>t("getShareUrl",[a]),getConfig:a=>t("getConfig",[a]),setConfig:a=>t("setConfig",[a]),getCode:()=>t("getCode"),show:(a,p)=>t("show",[a,p]),runTests:()=>t("runTests"),onChange:a=>c("code",a),watch:c,exec:(a,...p)=>t("exec",[a,...p]),destroy:()=>v?Promise.reject(w):(V(),Promise.resolve())}}function de(d={}){let{appUrl:m="https://livecodes.io",params:b={},config:u={},headless:A,import:O,lite:s,view:e,...i}=d,n;try{n=new URL(m)}catch(v){throw new Error(`${m} is not a valid URL.`)}let r=new URLSearchParams;Object.entries(i).forEach(([v,w])=>{w!==void 0&&n.searchParams.set(v,String(w))});let y=d.view==="headless"||A;if(s&&(console.warn(`Deprecation notice: "lite" option is deprecated. Use "config: { mode: 'lite' }" instead.`),typeof u=="object"&&u.mode==null?u.mode="lite":n.searchParams.set("lite","true")),e&&(console.warn('Deprecation notice: The "view" option has been moved to "config.view". For headless mode use "headless: true".'),typeof u=="object"&&u.view==null&&e!=="headless"?u.view=e:n.searchParams.set("view",e)),typeof u=="string")try{new URL(u),n.searchParams.set("config",encodeURIComponent(u))}catch(v){throw new Error('"config" is not a valid URL or configuration object.')}else u&&typeof u=="object"&&Object.keys(u).length>0&&(u.title&&u.title!=="Untitled Project"&&n.searchParams.set("title",u.title),u.description&&u.description.length>0&&n.searchParams.set("description",u.description),r.set("config","code/"+(0,K.compressToEncodedURIComponent)(JSON.stringify(u))));if(b&&typeof b=="object"&&Object.keys(b).length>0)try{r.set("params",(0,K.compressToEncodedURIComponent)(JSON.stringify(b)))}catch(v){Object.keys(b).forEach(w=>{n.searchParams.set(w,encodeURIComponent(String(b[w])))})}return O&&n.searchParams.set("x",encodeURIComponent(O)),y&&n.searchParams.set("headless","true"),r.toString().length>0&&(n.hash=r.toString()),n.href}import{jsx as pe}from"react/jsx-runtime";function ue(d){let m=fe(null),[b,u]=k(d.className||""),[A,O]=k(d.style||{}),[s,e]=k(d.height),[i,n]=k(),[r,y]=k(JSON.stringify(d.config||"")),[v,w]=k("");return Y(()=>{if(!m.current)return;let{className:M,style:g,height:S,sdkReady:E,config:l,...f}=d;if(u(M||""),O(g||{}),e(S),!i||v!==JSON.stringify(f))w(JSON.stringify(f)),i==null||i.destroy(),X(m.current,{config:l,...f}).then(t=>{n(t),typeof E=="function"&&E(t)});else{if(r===JSON.stringify(l))return;y(JSON.stringify(l)),typeof l=="string"?fetch(l).then(t=>t.json()).then(t=>{i==null||i.setConfig(t)}):l&&i.setConfig(l)}},[d]),Y(()=>()=>{i==null||i.destroy()},[]),pe("div",{ref:m,className:b,style:A,"data-height":s})}export{ue as default};
