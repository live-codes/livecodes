var z=Object.create;var M=Object.defineProperty;var K=Object.getOwnPropertyDescriptor;var H=Object.getOwnPropertyNames;var J=Object.getPrototypeOf,V=Object.prototype.hasOwnProperty;var Z=(e,i)=>()=>(i||e((i={exports:{}}).exports,i),i.exports);var G=(e,i,f,d)=>{if(i&&typeof i=="object"||typeof i=="function")for(let g of H(i))!V.call(e,g)&&g!==f&&M(e,g,{get:()=>i[g],enumerable:!(d=K(i,g))||d.enumerable});return e};var Q=(e,i,f)=>(f=e!=null?z(J(e)):{},G(i||!e||!e.__esModule?M(f,"default",{value:e,enumerable:!0}):f,e));var F=Z((Ne,C)=>{var W=function(){var e=String.fromCharCode,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",d={};function g(t,n){if(!d[t]){d[t]={};for(var a=0;a<t.length;a++)d[t][t.charAt(a)]=a}return d[t][n]}var m={compressToBase64:function(t){if(t==null)return"";var n=m._compress(t,6,function(a){return i.charAt(a)});switch(n.length%4){default:case 0:return n;case 1:return n+"===";case 2:return n+"==";case 3:return n+"="}},decompressFromBase64:function(t){return t==null?"":t==""?null:m._decompress(t.length,32,function(n){return g(i,t.charAt(n))})},compressToUTF16:function(t){return t==null?"":m._compress(t,15,function(n){return e(n+32)})+" "},decompressFromUTF16:function(t){return t==null?"":t==""?null:m._decompress(t.length,16384,function(n){return t.charCodeAt(n)-32})},compressToUint8Array:function(t){for(var n=m.compress(t),a=new Uint8Array(n.length*2),o=0,l=n.length;o<l;o++){var h=n.charCodeAt(o);a[o*2]=h>>>8,a[o*2+1]=h%256}return a},decompressFromUint8Array:function(t){if(t==null)return m.decompress(t);for(var n=new Array(t.length/2),a=0,o=n.length;a<o;a++)n[a]=t[a*2]*256+t[a*2+1];var l=[];return n.forEach(function(h){l.push(e(h))}),m.decompress(l.join(""))},compressToEncodedURIComponent:function(t){return t==null?"":m._compress(t,6,function(n){return f.charAt(n)})},decompressFromEncodedURIComponent:function(t){return t==null?"":t==""?null:(t=t.replace(/ /g,"+"),m._decompress(t.length,32,function(n){return g(f,t.charAt(n))}))},compress:function(t){return m._compress(t,16,function(n){return e(n)})},_compress:function(t,n,a){if(t==null)return"";var o,l,h={},w={},v="",U="",y="",x=2,S=3,p=2,u=[],r=0,s=0,b;for(b=0;b<t.length;b+=1)if(v=t.charAt(b),Object.prototype.hasOwnProperty.call(h,v)||(h[v]=S++,w[v]=!0),U=y+v,Object.prototype.hasOwnProperty.call(h,U))y=U;else{if(Object.prototype.hasOwnProperty.call(w,y)){if(y.charCodeAt(0)<256){for(o=0;o<p;o++)r=r<<1,s==n-1?(s=0,u.push(a(r)),r=0):s++;for(l=y.charCodeAt(0),o=0;o<8;o++)r=r<<1|l&1,s==n-1?(s=0,u.push(a(r)),r=0):s++,l=l>>1}else{for(l=1,o=0;o<p;o++)r=r<<1|l,s==n-1?(s=0,u.push(a(r)),r=0):s++,l=0;for(l=y.charCodeAt(0),o=0;o<16;o++)r=r<<1|l&1,s==n-1?(s=0,u.push(a(r)),r=0):s++,l=l>>1}x--,x==0&&(x=Math.pow(2,p),p++),delete w[y]}else for(l=h[y],o=0;o<p;o++)r=r<<1|l&1,s==n-1?(s=0,u.push(a(r)),r=0):s++,l=l>>1;x--,x==0&&(x=Math.pow(2,p),p++),h[U]=S++,y=String(v)}if(y!==""){if(Object.prototype.hasOwnProperty.call(w,y)){if(y.charCodeAt(0)<256){for(o=0;o<p;o++)r=r<<1,s==n-1?(s=0,u.push(a(r)),r=0):s++;for(l=y.charCodeAt(0),o=0;o<8;o++)r=r<<1|l&1,s==n-1?(s=0,u.push(a(r)),r=0):s++,l=l>>1}else{for(l=1,o=0;o<p;o++)r=r<<1|l,s==n-1?(s=0,u.push(a(r)),r=0):s++,l=0;for(l=y.charCodeAt(0),o=0;o<16;o++)r=r<<1|l&1,s==n-1?(s=0,u.push(a(r)),r=0):s++,l=l>>1}x--,x==0&&(x=Math.pow(2,p),p++),delete w[y]}else for(l=h[y],o=0;o<p;o++)r=r<<1|l&1,s==n-1?(s=0,u.push(a(r)),r=0):s++,l=l>>1;x--,x==0&&(x=Math.pow(2,p),p++)}for(l=2,o=0;o<p;o++)r=r<<1|l&1,s==n-1?(s=0,u.push(a(r)),r=0):s++,l=l>>1;for(;;)if(r=r<<1,s==n-1){u.push(a(r));break}else s++;return u.join("")},decompress:function(t){return t==null?"":t==""?null:m._decompress(t.length,32768,function(n){return t.charCodeAt(n)})},_decompress:function(t,n,a){var o=[],l,h=4,w=4,v=3,U="",y=[],x,S,p,u,r,s,b,c={val:a(0),position:n,index:1};for(x=0;x<3;x+=1)o[x]=x;for(p=0,r=Math.pow(2,2),s=1;s!=r;)u=c.val&c.position,c.position>>=1,c.position==0&&(c.position=n,c.val=a(c.index++)),p|=(u>0?1:0)*s,s<<=1;switch(l=p){case 0:for(p=0,r=Math.pow(2,8),s=1;s!=r;)u=c.val&c.position,c.position>>=1,c.position==0&&(c.position=n,c.val=a(c.index++)),p|=(u>0?1:0)*s,s<<=1;b=e(p);break;case 1:for(p=0,r=Math.pow(2,16),s=1;s!=r;)u=c.val&c.position,c.position>>=1,c.position==0&&(c.position=n,c.val=a(c.index++)),p|=(u>0?1:0)*s,s<<=1;b=e(p);break;case 2:return""}for(o[3]=b,S=b,y.push(b);;){if(c.index>t)return"";for(p=0,r=Math.pow(2,v),s=1;s!=r;)u=c.val&c.position,c.position>>=1,c.position==0&&(c.position=n,c.val=a(c.index++)),p|=(u>0?1:0)*s,s<<=1;switch(b=p){case 0:for(p=0,r=Math.pow(2,8),s=1;s!=r;)u=c.val&c.position,c.position>>=1,c.position==0&&(c.position=n,c.val=a(c.index++)),p|=(u>0?1:0)*s,s<<=1;o[w++]=e(p),b=w-1,h--;break;case 1:for(p=0,r=Math.pow(2,16),s=1;s!=r;)u=c.val&c.position,c.position>>=1,c.position==0&&(c.position=n,c.val=a(c.index++)),p|=(u>0?1:0)*s,s<<=1;o[w++]=e(p),b=w-1,h--;break;case 2:return y.join("")}if(h==0&&(h=Math.pow(2,v),v++),o[b])U=o[b];else if(b===w)U=S+S.charAt(0);else return null;y.push(U),o[w++]=S+U.charAt(0),h--,S=U,h==0&&(h=Math.pow(2,v),v++)}}};return m}();typeof define=="function"&&define.amd?define(function(){return W}):typeof C<"u"&&C!=null&&(C.exports=W)});var B=e=>(globalThis.structuredClone||(i=>JSON.parse(JSON.stringify(i,(f,d)=>d===void 0?null:d))))(e);var X=()=>String(Math.random())+"-"+Date.now().toFixed();var _=async(e,i)=>new Promise(f=>{let d=X(),g=m=>{let t=m.data;t.method===i.method&&t.messageId===d&&(e.removeEventListener("message",g),f(t.data))};e.addEventListener("message",g),e.postMessage({...i,messageId:d})});var R=["esm.sh","skypack","jspm"],$=["jsdelivr","fastly.jsdelivr","unpkg"],I=["jsdelivr.gh","fastly.jsdelivr.gh","statically"],k={getModuleUrl:(e,{isModule:i=!0,defaultCDN:f="esm.sh"}={})=>{e=e.replace(/#nobundle/g,"");let d=D(e,i,f);return d||(i?"https://esm.sh/"+e:"https://cdn.jsdelivr.net/npm/"+e)},getUrl:(e,i)=>e.startsWith("http")||e.startsWith("data:")?e:D(e,!1,i||L())||e,cdnLists:{npm:$,module:R,gh:I},checkCDNs:async(e,i)=>{let f=[i,...k.cdnLists.npm].filter(Boolean);for(let d of f)try{if((await fetch(k.getUrl(e,d),{method:"HEAD"})).ok)return d}catch{}return k.cdnLists.npm[0]}},L=()=>{if(globalThis.appCDN)return globalThis.appCDN;try{return new URL(location.href).searchParams.get("appCDN")||k.cdnLists.npm[0]}catch{return k.cdnLists.npm[0]}},D=(e,i,f)=>{let d=i&&e.startsWith("unpkg:")?"?module":"";e.startsWith("gh:")?e=e.replace("gh",I[0]):e.includes(":")||(e=(f||(i?R[0]:$[0]))+":"+e);for(let g of Y){let[m,t]=g;if(m.test(e))return e.replace(m,t)+d}return null},Y=[[/^(jspm:)(.+)/i,"https://jspm.dev/$2"],[/^(npm:)(.+)/i,"https://esm.sh/$2"],[/^(node:)(.+)/i,"https://esm.sh/$2"],[/^(jsr:)(.+)/i,"https://esm.sh/jsr/$2"],[/^(skypack:)(.+)/i,"https://cdn.skypack.dev/$2"],[/^(jsdelivr:)(.+)/i,"https://cdn.jsdelivr.net/npm/$2"],[/^(fastly.jsdelivr:)(.+)/i,"https://fastly.jsdelivr.net/npm/$2"],[/^(jsdelivr.gh:)(.+)/i,"https://cdn.jsdelivr.net/gh/$2"],[/^(fastly.jsdelivr.gh:)(.+)/i,"https://fastly.jsdelivr.net/gh/$2"],[/^(statically:)(.+)/i,"https://cdn.statically.io/gh/$2"],[/^(esm.run:)(.+)/i,"https://esm.run/$2"],[/^(esm.sh:)(.+)/i,"https://esm.sh/$2"],[/^(esbuild:)(.+)/i,"https://esbuild.vercel.app/$2"],[/^(bundle.run:)(.+)/i,"https://bundle.run/$2"],[/^(unpkg:)(.+)/i,"https://unpkg.com/$2"],[/^(bundlejs:)(.+)/i,"https://deno.bundlejs.com/?file&q=$2"],[/^(bundle:)(.+)/i,"https://deno.bundlejs.com/?file&q=$2"],[/^(deno:)(.+)/i,"https://deno.bundlejs.com/?file&q=https://deno.land/x/$2/mod.ts"],[/^(https:\/\/deno\.land\/.+)/i,"https://deno.bundlejs.com/?file&q=$1"],[/^(github:|https:\/\/github\.com\/)(.[^\/]+?)\/(.[^\/]+?)\/(?!releases\/)(?:(?:blob|raw)\/)?(.+?\/.+)/i,"https://deno.bundlejs.com/?file&q=https://cdn.jsdelivr.net/gh/$2/$3@$4"],[/^(gist\.github:)(.+?\/[0-9a-f]+\/raw\/(?:[0-9a-f]+\/)?.+)$/i,"https://gist.githack.com/$2"],[/^(gitlab:|https:\/\/gitlab\.com\/)([^\/]+.*\/[^\/]+)\/(?:raw|blob)\/(.+?)(?:\?.*)?$/i,"https://deno.bundlejs.com/?file&q=https://gl.githack.com/$2/raw/$3"],[/^(bitbucket:|https:\/\/bitbucket\.org\/)([^\/]+\/[^\/]+)\/(?:raw|src)\/(.+?)(?:\?.*)?$/i,"https://deno.bundlejs.com/?file&q=https://bb.githack.com/$2/raw/$3"],[/^(bitbucket:)snippets\/([^\/]+\/[^\/]+)\/revisions\/([^\/\#\?]+)(?:\?[^#]*)?(?:\#file-(.+?))$/i,"https://bb.githack.com/!api/2.0/snippets/$2/$3/files/$4"],[/^(bitbucket:)snippets\/([^\/]+\/[^\/\#\?]+)(?:\?[^#]*)?(?:\#file-(.+?))$/i,"https://bb.githack.com/!api/2.0/snippets/$2/HEAD/files/$3"],[/^(bitbucket:)\!api\/2.0\/snippets\/([^\/]+\/[^\/]+\/[^\/]+)\/files\/(.+?)(?:\?.*)?$/i,"https://bb.githack.com/!api/2.0/snippets/$2/files/$3"],[/^(api\.bitbucket:)2.0\/snippets\/([^\/]+\/[^\/]+\/[^\/]+)\/files\/(.+?)(?:\?.*)?$/i,"https://bb.githack.com/!api/2.0/snippets/$2/files/$3"],[/^(rawgit:)(.+?\/[0-9a-f]+\/raw\/(?:[0-9a-f]+\/)?.+)$/i,"https://gist.githack.com/$2"],[/^(rawgit:|https:\/\/raw\.githubusercontent\.com)(\/[^\/]+\/[^\/]+|[0-9A-Za-z-]+\/[0-9a-f]+\/raw)\/(.+)/i,"https://deno.bundlejs.com/?file&q=https://raw.githack.com/$2/$3"]];var{getUrl:ee,getModuleUrl:pe}=k;var te="0.6.64",de=ee(`malinajs@${te}/malina.js`);var A=()=>{let e=[];return{subscribe:m=>(e.push(m),{unsubscribe:()=>{e.splice(e.indexOf(m),1)}}),notify:m=>{e.forEach(t=>{t(m)})},hasSubscribers:()=>e.length>0,unsubscribeAll:()=>{e.length=0}}};var q={getValue:()=>null,setValue:()=>{},clear:()=>{},subscribe:()=>({unsubscribe:()=>{}}),unsubscribeAll:()=>{}};var T=(e,i)=>{if(i)return q;let f=A(),d=o=>f.subscribe(o),g=()=>{f.unsubscribeAll()},m=()=>{f.notify(n())},t=o=>{window.localStorage.setItem(e,JSON.stringify(o)),m()},n=()=>{let o=window.localStorage.getItem(e);if(!o)return null;try{return JSON.parse(o)}catch{return null}};return{getValue:n,setValue:t,clear:()=>{t(null),m()},subscribe:d,unsubscribeAll:g}};var P=()=>B({projects:null,templates:null,assets:null,snippets:null,recover:null,userConfig:null,userData:null,appData:null,sync:null});var N=async(e,i)=>{i||(e.recover=T("__livecodes_project_recover__",i),e.userConfig=T("__livecodes_user_config__",i),e.appData=T("__livecodes_app_data__",i))};var E=Q(F());var j,nt=e=>{j=j||new Worker(e+"sync.worker.c5d4f10795b8543fb1397d05464bb7b0.js?appCDN="+L());let i;j.addEventListener("message",async f=>{let d=f.data,g=d.method,m=d.args||{};if(g!=="getValue"&&g!=="setValue")return;i||(i=P(),await N(i,!1));let t,{storeKey:n,value:a}=m,o=i[n];!o||!n||(g==="getValue"&&"getValue"in o&&(t=o.getValue()),g==="setValue"&&"setValue"in o&&a!=null&&o.setValue(a),j.postMessage({...d,data:t}))})},it=async(...e)=>_(j,{method:"sync",args:e}),ct=async(...e)=>_(j,{method:"exportToLocalSync",args:e}),at=async(...e)=>_(j,{method:"exportStoreAsBase64Update",args:e}),lt=async(...e)=>_(j,{method:"restoreFromUpdate",args:e}),pt=async(...e)=>_(j,{method:"restoreFromLocalSync",args:e});export{at as exportStoreAsBase64Update,ct as exportToLocalSync,nt as init,pt as restoreFromLocalSync,lt as restoreFromUpdate,it as sync};
