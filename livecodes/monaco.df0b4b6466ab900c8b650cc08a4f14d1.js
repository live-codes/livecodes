var de=t=>(globalThis.structuredClone||(o=>JSON.parse(JSON.stringify(o,(n,r)=>r===void 0?null:r))))(t);var ge=()=>String(Math.random())+"-"+Date.now().toFixed();var R=(t,o)=>new Promise((n,r)=>{if(o&&globalThis[o])return n(globalThis[o]);if(typeof globalThis.importScripts=="function")return globalThis.importScripts(t),o&&globalThis[o]?n(globalThis[o]):n(globalThis);let c=document.createElement("script");c.src=t,c.async=!0;let s=()=>{c.removeEventListener("load",l),c.removeEventListener("error",T)},l=()=>{if(s(),!o)return n("loaded: "+t);let d=setInterval(()=>{if(window[o])return clearInterval(d),n(window[o])},5)},T=()=>{s(),r("failed to load: "+t)};c.addEventListener("load",l),c.addEventListener("error",T),document.head.appendChild(c)});var se=t=>t.replace(/\/\*[\s\S]*?\*\/|([^\\:]|^)\/\/.*$/gm,"$1");var fe=["esm.sh","skypack","esm.run","jsdelivr.esm","fastly.jsdelivr.esm","gcore.jsdelivr.esm","testingcf.jsdelivr.esm","jsdelivr.b-cdn.esm","jspm"],xe=["jsdelivr","fastly.jsdelivr","unpkg","gcore.jsdelivr","testingcf.jsdelivr","jsdelivr.b-cdn","npmcdn"],ye=["jsdelivr.gh","fastly.jsdelivr.gh","statically","gcore.jsdelivr.gh","testingcf.jsdelivr.gh","jsdelivr.b-cdn.gh"],U={getModuleUrl:(t,{isModule:o=!0,defaultCDN:n="esm.sh"}={})=>{t=t.replace(/#nobundle/g,"");let r=he(t,o,n);return r||(o?"https://esm.sh/"+t:"https://cdn.jsdelivr.net/npm/"+t)},getUrl:(t,o)=>t.startsWith("http")||t.startsWith("data:")?t:he(t,!1,o||dt())||t,cdnLists:{npm:xe,module:fe,gh:ye},checkCDNs:async(t,o)=>{let n=[o,...U.cdnLists.npm].filter(Boolean);for(let r of n)try{if((await fetch(U.getUrl(t,r),{method:"HEAD"})).ok)return r}catch{}return U.cdnLists.npm[0]}},dt=()=>{if(globalThis.appCDN)return globalThis.appCDN;try{return new URL(location.href).searchParams.get("appCDN")||U.cdnLists.npm[0]}catch{return U.cdnLists.npm[0]}},he=(t,o,n)=>{let r=o&&t.startsWith("unpkg:")?"?module":"";t.startsWith("gh:")?t=t.replace("gh",ye[0]):t.includes(":")||(t=(n||(o?fe[0]:xe[0]))+":"+t);for(let c of gt){let[s,l]=c;if(s.test(t))return t.replace(s,l)+r}return null},gt=[[/^(esm\.sh:)(.+)/i,"https://esm.sh/$2"],[/^(npm:)(.+)/i,"https://esm.sh/$2"],[/^(node:)(.+)/i,"https://esm.sh/$2"],[/^(jsr:)(.+)/i,"https://esm.sh/jsr/$2"],[/^(skypack:)(.+)/i,"https://cdn.skypack.dev/$2"],[/^(jsdelivr:)(.+)/i,"https://cdn.jsdelivr.net/npm/$2"],[/^(fastly\.jsdelivr:)(.+)/i,"https://fastly.jsdelivr.net/npm/$2"],[/^(gcore\.jsdelivr:)(.+)/i,"https://gcore.jsdelivr.net/npm/$2"],[/^(testingcf\.jsdelivr:)(.+)/i,"https://testingcf.jsdelivr.net/npm/$2"],[/^(jsdelivr\.b-cdn:)(.+)/i,"https://jsdelivr.b-cdn.net/npm/$2"],[/^(jsdelivr\.gh:)(.+)/i,"https://cdn.jsdelivr.net/gh/$2"],[/^(fastly\.jsdelivr\.gh:)(.+)/i,"https://fastly.jsdelivr.net/gh/$2"],[/^(gcore\.jsdelivr\.gh:)(.+)/i,"https://gcore.jsdelivr.net/gh/$2"],[/^(testingcf\.jsdelivr\.gh:)(.+)/i,"https://testingcf.jsdelivr.net/gh/$2"],[/^(jsdelivr\.b-cdn\.gh:)(.+)/i,"https://jsdelivr.b-cdn.net/gh/$2"],[/^(statically:)(.+)/i,"https://cdn.statically.io/gh/$2"],[/^(esm\.run:)(.+)/i,"https://esm.run/$2"],[/^(jsdelivr\.esm:)(.+)/i,"https://cdn.jsdelivr.net/npm/$2/+esm"],[/^(fastly\.jsdelivr\.esm:)(.+)/i,"https://fastly.jsdelivr.net/npm/$2/+esm"],[/^(gcore\.jsdelivr\.esm:)(.+)/i,"https://gcore.jsdelivr.net/npm/$2/+esm"],[/^(testingcf\.jsdelivr\.esm:)(.+)/i,"https://testingcf.jsdelivr.net/npm/$2/+esm"],[/^(jsdelivr\.b-cdn\.esm:)(.+)/i,"https://jsdelivr.b-cdn.net/npm/$2/+esm"],[/^(jspm:)(.+)/i,"https://jspm.dev/$2"],[/^(esbuild:)(.+)/i,"https://esbuild.vercel.app/$2"],[/^(bundle\.run:)(.+)/i,"https://bundle.run/$2"],[/^(unpkg:)(.+)/i,"https://unpkg.com/$2"],[/^(npmcdn:)(.+)/i,"https://npmcdn.com/$2"],[/^(bundlejs:)(.+)/i,"https://deno.bundlejs.com/?file&q=$2"],[/^(bundle:)(.+)/i,"https://deno.bundlejs.com/?file&q=$2"],[/^(deno:)(.+)/i,"https://deno.bundlejs.com/?file&q=https://deno.land/x/$2/mod.ts"],[/^(https:\/\/deno\.land\/.+)/i,"https://deno.bundlejs.com/?file&q=$1"],[/^(github:|https:\/\/github\.com\/)(.[^\/]+?)\/(.[^\/]+?)\/(?!releases\/)(?:(?:blob|raw)\/)?(.+?\/.+)/i,"https://deno.bundlejs.com/?file&q=https://cdn.jsdelivr.net/gh/$2/$3@$4"],[/^(gist\.github:)(.+?\/[0-9a-f]+\/raw\/(?:[0-9a-f]+\/)?.+)$/i,"https://gist.githack.com/$2"],[/^(gitlab:|https:\/\/gitlab\.com\/)([^\/]+.*\/[^\/]+)\/(?:raw|blob)\/(.+?)(?:\?.*)?$/i,"https://deno.bundlejs.com/?file&q=https://gl.githack.com/$2/raw/$3"],[/^(bitbucket:|https:\/\/bitbucket\.org\/)([^\/]+\/[^\/]+)\/(?:raw|src)\/(.+?)(?:\?.*)?$/i,"https://deno.bundlejs.com/?file&q=https://bb.githack.com/$2/raw/$3"],[/^(bitbucket:)snippets\/([^\/]+\/[^\/]+)\/revisions\/([^\/\#\?]+)(?:\?[^#]*)?(?:\#file-(.+?))$/i,"https://bb.githack.com/!api/2.0/snippets/$2/$3/files/$4"],[/^(bitbucket:)snippets\/([^\/]+\/[^\/\#\?]+)(?:\?[^#]*)?(?:\#file-(.+?))$/i,"https://bb.githack.com/!api/2.0/snippets/$2/HEAD/files/$3"],[/^(bitbucket:)\!api\/2.0\/snippets\/([^\/]+\/[^\/]+\/[^\/]+)\/files\/(.+?)(?:\?.*)?$/i,"https://bb.githack.com/!api/2.0/snippets/$2/files/$3"],[/^(api\.bitbucket:)2.0\/snippets\/([^\/]+\/[^\/]+\/[^\/]+)\/files\/(.+?)(?:\?.*)?$/i,"https://bb.githack.com/!api/2.0/snippets/$2/files/$3"],[/^(rawgit:)(.+?\/[0-9a-f]+\/raw\/(?:[0-9a-f]+\/)?.+)$/i,"https://gist.githack.com/$2"],[/^(rawgit:|https:\/\/raw\.githubusercontent\.com)(\/[^\/]+\/[^\/]+|[0-9A-Za-z-]+\/[0-9a-f]+\/raw)\/(.+)/i,"https://deno.bundlejs.com/?file&q=https://raw.githack.com/$2/$3"]];var{getUrl:B,getModuleUrl:Ut}=U,be="5.5.2";var Te=B("@live-codes/monaco-codeium-provider@0.2.2/dist/index.js");var Ee=B("emmet-monaco-es@5.0.0/dist/emmet-monaco.js");var ht="0.6.64",It=B(`malinajs@${ht}/malina.js`);var ie=`https://typescript.azureedge.net/cdn/${be}/monaco/min/vs`,Le=B("monaco-emacs@0.3.0/dist/monaco-emacs.js"),a=B("monaco-themes@0.4.4/themes/"),Me=B("monaco-vim@0.4.0/dist/monaco-vim.js");var Se=B(`typescript@${be}/lib/typescript.js`);var ft=/(import\s+?(?:(?:(?:[\w*\s{},\$]*)\s+from\s+?)|))((?:".*?")|(?:'.*?'))([\s]*?(?:;|$|))/g,xt=/(import\s*?\(\s*?((?:".*?")|(?:'.*?'))\s*?\))/g,we=(t,o=!1)=>[...se(t).matchAll(new RegExp(ft)),...se(t).matchAll(new RegExp(xt))].map(n=>n[2].replace(/"/g,"").replace(/'/g,"")).map(n=>!o||!yt(n)||!n.includes(":")?n:n.split(":")[1]);var yt=t=>!t.startsWith("https://")&&!t.startsWith("http://")&&!t.startsWith(".")&&!t.startsWith("/")&&!t.startsWith("data:")&&!t.startsWith("blob:");var ve=()=>document.querySelector("#editor-mode");var je=t=>{if(!t.startsWith("https://"))return t;let o=["https://esm.sh/","https://cdn.skypack.dev/","https://cdn.jsdelivr.net/npm/","https://fastly.jsdelivr.net/npm/","https://gcore.jsdelivr.net/npm/","https://testingcf.jsdelivr.net/npm/","https://jsdelivr.b-cdn.net/npm/","https://esm.run/","https://esbuild.vercel.app/","https://bundle.run/","https://unpkg.com/","https://npmcdn.com/","https://deno.bundlejs.com/?file&q=","https://jspm.dev/"];for(let n of o)if(t.startsWith(n))return t.replace(n,"");return t},ke=t=>t.includes(":")&&!t.startsWith("data:")&&!t.startsWith("http")?t.split(":")[1]:t;var He=t=>`https://ofcncog2cu-dsn.algolia.net/1/indexes/npm-search/${encodeURIComponent(t)}?x-algolia-agent=Browser`,Ce={"X-Algolia-Application-Id":"OFCNCOG2CU","X-Algolia-API-Key":"f54e21fa3a2a0160595bb058179bfb1e"},qe=["name","description","homepage","repository.url","version"],ae="https://data.jsdelivr.com/v1",ce={"User-Agent":"https://livecodes.io"},V=t=>{let o=t.startsWith("@"),n=o?t.slice(1):t,[r,c]=n.split("@");return[(o?"@":"")+r,c]},bt=async(t,o=10)=>{let n={page:0,hitsPerPage:o,attributesToHighlight:[],attributesToRetrieve:qe,analyticsTags:["jsdelivr"]},[r,c]=V(t),s;if(c){let d=await Y(t);typeof d=="string"&&(s=V(d)[1])}let l=await fetch(He("query"),{method:"POST",headers:{"Content-Type":"application/json; charset=UTF-8",...Ce},body:JSON.stringify({query:r,...n})}).then(d=>{if(!d.ok)throw new Error("failed to fetch");return d}).then(d=>d.json()).catch(d=>({error:!0,message:d.mesage||String(d)}));if("error"in l)return l;let T=l.hits.map(d=>(d.name===r&&s&&(d.version=s),d.repository?.url&&(d.repo=d.repository?.url),d));return T.sort((d,A)=>d.name===r?-1:A.name===r?1:0),T},Y=async t=>{let o=`${ae}/package/resolve/npm/${t}`,n=await fetch(o,{headers:ce}).then(s=>{if(!s.ok)throw new Error("failed to fetch");return s}).then(s=>s.json()).catch(s=>({error:!0,message:s.mesage||String(s)}));if("error"in n)return n;let r=V(t)[0],c=n.version;return c?`${r}@${c}`:r},Tt=async t=>{let[o,n]=V(ke(je(t))),r;if(n){let l=await Y(t);typeof l=="string"&&(r=V(l)[1])}let c=He(o)+"&attributesToRetrieve="+qe.join(","),s=await fetch(c,{method:"GET",headers:Ce}).then(l=>{if(!l.ok)throw new Error("failed to fetch");return l}).then(l=>l.json()).catch(l=>({error:!0,message:l.mesage||String(l)}));return"error"in s||(r&&(s.version=r),s.repository?.url&&(s.repo=s.repository?.url)),s},Et=async t=>{let o=await Y(t),n=`${ae}/package/npm/${o}/flat`,r=await fetch(n,{headers:ce}).then(s=>{if(!s.ok)throw new Error("failed to fetch");return s}).then(s=>s.json()).catch(s=>({error:!0,message:s.mesage||String(s)}));if("error"in r)return r;let c=`https://cdn.jsdelivr.net/npm/${o}`;return{...r.default?{default:c+r.default}:{},files:r.files.map(s=>c+s.name)}},Lt=async t=>{let o=await Y(t),n=`${ae}/package/npm/${o}/entrypoints`,r=await fetch(n,{headers:ce}).then(s=>{if(!s.ok)throw new Error("failed to fetch");return s}).then(s=>s.json()).catch(s=>({error:!0,message:s.mesage||String(s)}));if("error"in r)return r;let c=`https://cdn.jsdelivr.net/npm/${o}`;return{...r.js?.file?{js:c+r.js?.file}:{},...r.css?.file?{css:c+r.css?.file}:{}}},Ue={search:bt,getPkgInfo:Tt,getPkgFiles:Et,getPkgDefaultFiles:Lt};var Mt=t=>{let o=t.trim(),n,r;return t.includes(":")&&([n,o]=o.split(":"),n!=="monaco"&&n!=="codemirror"&&n!=="codejar"&&(n=void 0)),t.includes("@")&&([o,r]=o.split("@"),r!=="light"&&r!=="dark"&&(r=void 0)),{editor:n,editorTheme:o,theme:r}},Ie=({editor:t,editorTheme:o,theme:n,editorThemes:r})=>{if(!o)return null;let s=(typeof o=="string"?o.split(",").map(l=>l.trim()):o).map(Mt);for(let l of s)if((l.editor===t||l.editor===void 0)&&(l.theme===n||l.theme===void 0)&&r.includes(l.editorTheme))return l.editorTheme;return null};var le=[{name:"active4d",title:"Active4D",url:a+"Active4D.json"},{name:"all-hallows-eve",title:"All Hallows Eve",url:a+"All Hallows Eve.json"},{name:"amy",title:"Amy",url:a+"Amy.json"},{name:"birds-of-paradise",title:"Birds of Paradise",url:a+"Birds of Paradise.json"},{name:"blackboard",title:"Blackboard",url:a+"Blackboard.json"},{name:"brilliance-black",title:"Brilliance Black",url:a+"Brilliance Black.json"},{name:"brilliance-dull",title:"Brilliance Dull",url:a+"Brilliance Dull.json"},{name:"chrome-devtools",title:"Chrome DevTools",url:a+"Chrome DevTools.json"},{name:"clouds-midnight",title:"Clouds Midnight",url:a+"Clouds Midnight.json"},{name:"clouds",title:"Clouds",url:a+"Clouds.json"},{name:"cobalt",title:"Cobalt",url:a+"Cobalt.json"},{name:"cobalt2",title:"Cobalt2",url:a+"Cobalt2.json"},{name:"dawn",title:"Dawn",url:a+"Dawn.json"},{name:"dracula",title:"Dracula",url:a+"Dracula.json"},{name:"dreamweaver",title:"Dreamweaver",url:a+"Dreamweaver.json"},{name:"eiffel",title:"Eiffel",url:a+"Eiffel.json"},{name:"espresso-libre",title:"Espresso Libre",url:a+"Espresso Libre.json"},{name:"github",title:"GitHub",url:a+"GitHub.json"},{name:"github-dark",title:"GitHub Dark",url:a+"GitHub Dark.json"},{name:"github-light",title:"GitHub Light",url:a+"GitHub Light.json"},{name:"hc-black",title:"High Contrast (Black)"},{name:"hc-light",title:"High Contrast (Light)"},{name:"idle",title:"Idle",url:a+"IDLE.json"},{name:"idlefingers",title:"Idle Fingers",url:a+"idleFingers.json"},{name:"iplastic",title:"iPlastic",url:a+"iPlastic.json"},{name:"katzenmilch",title:"Katzenmilch",url:a+"Katzenmilch.json"},{name:"krtheme",title:"krTheme",url:a+"krTheme.json"},{name:"kuroir",title:"Kuroir Theme",url:a+"Kuroir Theme.json"},{name:"lazy",title:"Lazy",url:a+"LAZY.json"},{name:"magicwb-amiga",title:"MagicWB (Amiga)",url:a+"MagicWB (Amiga).json"},{name:"merbivore-soft",title:"Merbivore Soft",url:a+"Merbivore Soft.json"},{name:"merbivore",title:"Merbivore",url:a+"Merbivore.json"},{name:"monochrome",title:"Monochrome"},{name:"monochrome-dark",title:"Monochrome Dark"},{name:"monoindustrial",title:"monoindustrial",url:a+"monoindustrial.json"},{name:"monokai",title:"Monokai",url:a+"Monokai.json"},{name:"monokai-bright",title:"Monokai Bright",url:a+"Monokai Bright.json"},{name:"night-owl",title:"Night Owl",url:a+"Night Owl.json"},{name:"nord",title:"Nord",url:a+"Nord.json"},{name:"oceanic-next",title:"Oceanic Next",url:a+"Oceanic Next.json"},{name:"pastels-on-dark",title:"Pastels on Dark",url:a+"Pastels on Dark.json"},{name:"slush-and-poppies",title:"Slush and Poppies",url:a+"Slush and Poppies.json"},{name:"solarized-dark",title:"Solarized Dark",url:a+"Solarized-dark.json"},{name:"solarized-light",title:"Solarized Light",url:a+"Solarized-light.json"},{name:"spacecadet",title:"SpaceCadet",url:a+"SpaceCadet.json"},{name:"sunburst",title:"Sunburst",url:a+"Sunburst.json"},{name:"textmate-mac-classic",title:"Textmate (Mac Classic)",url:a+"Textmate (Mac Classic).json"},{name:"tomorrow",title:"Tomorrow",url:a+"Tomorrow.json"},{name:"tomorrow-night",title:"Tomorrow Night",url:a+"Tomorrow-Night.json"},{name:"tomorrow-night-blue",title:"Tomorrow Night Blue",url:a+"Tomorrow-Night-Blue.json"},{name:"tomorrow-night-bright",title:"Tomorrow Night Bright",url:a+"Tomorrow-Night-Bright.json"},{name:"tomorrow-night-eighties",title:"Tomorrow Night Eighties",url:a+"Tomorrow-Night-Eighties.json"},{name:"twilight",title:"Twilight",url:a+"Twilight.json"},{name:"upstream-sunburst",title:"Upstream Sunburst",url:a+"Upstream Sunburst.json"},{name:"vibrant-ink",title:"Vibrant Ink",url:a+"Vibrant Ink.json"},{name:"vs",title:"VS"},{name:"vs-dark",title:"VS Dark"},{name:"xcode-default",title:"Xcode Default",url:a+"Xcode_default.json"},{name:"zenburnesque",title:"Zenburnesque",url:a+"Zenburnesque.json"}],Be=[{name:"custom-vs-light",theme:{base:"vs",inherit:!0,rules:[{token:"comment",fontStyle:"italic"}],colors:{}}},{name:"custom-vs-dark",theme:{base:"vs-dark",inherit:!0,rules:[{token:"comment",fontStyle:"italic"}],colors:{}}},{name:"monochrome",theme:{base:"vs",inherit:!1,rules:[],colors:{"editor.foreground":"#24292e","editorBracketHighlight.foreground1":"#24292e","editorBracketHighlight.foreground2":"#24292e","editorBracketHighlight.foreground3":"#24292e","editorBracketHighlight.foreground4":"#24292e","editorBracketHighlight.unexpectedBracket.foreground":"#24292e"}}},{name:"monochrome-dark",theme:{base:"vs-dark",inherit:!1,rules:[],colors:{"editor.foreground":"#e2e2e3","editor.background":"#24292e","editorBracketHighlight.foreground1":"#e2e2e3","editorBracketHighlight.foreground2":"#e2e2e3","editorBracketHighlight.foreground3":"#e2e2e3","editorBracketHighlight.foreground4":"#e2e2e3","editorBracketHighlight.unexpectedBracket.foreground":"#e2e2e3"}}}];var St=/^\/\/\s?@(\w+)$/,wt=/^\/\/\s?@(\w+):\s?(.+)$/,Re=t=>{let o=new Map;if("optionDeclarations"in t)for(let n of t.optionDeclarations)o.set(n.name.toLowerCase(),n);return n=>{let r=n.split(`
`),c={};return r.forEach(s=>{let l,T=s.trim();(l=St.exec(T))?o.has(l[1].toLowerCase())&&(c[l[1]]=!0,Ae(l[1],"true",c,o)):(l=wt.exec(T))&&o.has(l[1].toLowerCase())&&Ae(l[1],l[2],c,o)}),c}};function Ae(t,o,n,r){let c=r.get(t.toLowerCase());if(c)switch(c.type){case"number":case"string":case"boolean":n[c.name]=Pe(o,c.type);break;case"list":let s=c.element.type,l=o.split(",");typeof s=="string"?n[c.name]=l.map(d=>Pe(d,s)):n[c.name]=l.map(d=>De(c.name,d,s)).filter(Boolean);break;default:let T=c.type;n[c.name]=De(c.name,o,T)}}function Pe(t,o){switch(o){case"number":return+t;case"string":return t;case"boolean":return t.toLowerCase()==="true"||t.length===0}}function De(t,o,n){return n.get(o.toLowerCase())}var $e=(t,o)=>(n,r,c)=>{let s=[],l=n.getValueInRange({startLineNumber:r.lineNumber,startColumn:0,endLineNumber:r.lineNumber,endColumn:r.column});if(!l.startsWith("//"))return{suggestions:[]};let T=l.replace("	","").split(" ");if(T.length!==2)return{suggestions:[]};let d=T[1];if(d.startsWith("-"))return{suggestions:[{label:"---cut---",kind:14,detail:"Twoslash split output",insertText:"---cut---".replace(d,"")}]};if(!d.startsWith("@"))return{suggestions:[]};let A=["noErrors","errors","showEmit","showEmittedFile","noStaticSemanticInfo","emit","noErrorValidation","filename"],$=t.optionDeclarations.map(k=>k.name);return A.concat($).forEach(k=>{k.startsWith(d.slice(1))&&s.push({label:k,kind:14,detail:"Twoslash comment",insertText:k})}),{suggestions:s}};var We=async({isJSLang:t,editor:o,monaco:n,compilerOptions:r})=>{let c=await R(Se,"ts"),s=t?"javascript":"typescript",l=t?n.languages.typescript.getJavaScriptWorker:n.languages.typescript.getTypeScriptWorker,T=t?n.languages.typescript.javascriptDefaults:n.languages.typescript.typescriptDefaults,d=o.getModel();["javascript","typescript"].forEach(y=>n.languages.registerCompletionItemProvider(y,{triggerCharacters:["@","/","-"],provideCompletionItems:$e(c,n)}));let $=y=>{let E=Object.keys(y);E.length&&(E.forEach(P=>{r[P]===y[P]&&delete y[P]}),Object.keys(y).length&&(r={...r,...y},T.setCompilerOptions(r)))},k=Re(c),x=()=>{let y=o.getModel()?.getValue();if(!y)return;let E=k(y);$(E)};x();let K=async()=>d?(await l())(d.uri):void 0,ee=()=>({provideInlayHints:async(E,P,H)=>{let D=E.getValue(),te=/^\s*\/\/\s*\^\?$/gm,W,O=[],G=await K();if(!G||E.isDisposed())return{hints:[],dispose:()=>{}};for(;(W=te.exec(D))!==null;){if(H.isCancellationRequested||E.isDisposed())return{hints:[],dispose:()=>{}};let L=W.index+W[0].length-1,I=E.getPositionAt(L),w=new n.Position(I.lineNumber-1,I.column),oe=E.getOffsetAt(w),N=await G.getQuickInfoAtPosition("file://"+E.uri.path,oe);if(!N||!N.displayParts)continue;let C=N.displayParts.map(Z=>Z.text).join("").replace(/\\n/g,"").replace(/  /g,"");C.length>120&&(C=C.slice(0,119)+"...");let ne={kind:0,position:new n.Position(I.lineNumber,I.column+1),label:C,paddingLeft:!0};O.push(ne)}return{hints:O,dispose:()=>{}}}});window.isInlayHintRegistered=window.isInlayHintRegistered||new Set,window.isInlayHintRegistered.has(s)||(n.languages.registerInlayHintsProvider(s,ee()),window.isInlayHintRegistered.add(s),o.getModel()?.onDidChangeContent(x))};var Oe=!1,j={},u,Ne=new Set,z,J=[],xo=async t=>{let{container:o,baseUrl:n,readonly:r,theme:c,editorTheme:s,isEmbed:l,getLanguageExtension:T,mapLanguage:d,getFormatterConfig:A,getFontFamily:$}=t;if(!o)throw new Error("editor container not found");let k=()=>new Promise(e=>{let i=document.createElement("script");i.src=ie+"/loader.js",i.addEventListener("load",()=>{let p=globalThis.require;p.config({paths:{vs:ie}}),p(["vs/editor/editor.main"],function(g){e(g)})}),document.body.appendChild(i)}),x,K=e=>({fontFamily:$(e.fontFamily),fontSize:e.fontSize||(l?12:14),insertSpaces:!e.useTabs,detectIndentation:!1,tabSize:e.tabSize,lineNumbers:e.lineNumbers?"on":"off",wordWrap:e.wordWrap?"on":"off",autoClosingBrackets:e.closeBrackets?"always":"never",autoClosingQuotes:e.closeBrackets?"always":"never",autoClosingDelete:e.closeBrackets?"always":"never"}),ee=K(t),y=e=>e==="livescript"?"coffeescript":["rescript","reason","ocaml"].includes(e)?"csharp":d(e);try{window.monaco=window.monaco||await k(),u=window.monaco}catch{throw new Error("Failed to load monaco editor")}Be.forEach(e=>u.editor.defineTheme(e.name,e.theme));let E=async(e,i)=>{let p=Ie({editor:"monaco",editorTheme:i,theme:e,editorThemes:le.map(m=>m.name)}),g=p==="vs"?"custom-vs-light":p==="vs-dark"?"custom-vs-dark":p||"custom-vs-"+e;if(Ne.has(g))return g;let h=le.find(m=>m.name===g);return h?.url&&await fetch(h.url).then(m=>m.json()).then(m=>{u.editor.defineTheme(g,m),Ne.add(g)}),g},P=(e,i)=>{E(e,i).then(p=>{u.editor.setTheme(p)})},H=navigator&&/android/i.test(navigator.userAgent),D={theme:await E(c,s),fontLigatures:!0,formatOnType:!1,lineNumbersMinChars:3,minimap:{enabled:!1},scrollbar:{useShadows:!1},mouseWheelZoom:!0,automaticLayout:!0,readOnly:r,fixedOverflowWidgets:!0,lightbulb:{enabled:"on"},quickSuggestions:{other:!H,comments:!H,strings:!H},acceptSuggestionOnCommitCharacter:!H,acceptSuggestionOnEnter:H?"off":"on",accessibilitySupport:H?"off":"on",inlayHints:{enabled:"on"}},te={...D,scrollBeyondLastLine:!1,contextmenu:!1},W={...D,scrollBeyondLastLine:!1},O={...D,glyphMargin:!0,folding:!1,lineDecorationsWidth:0,lineNumbersMinChars:0,scrollbar:{vertical:"auto"},scrollBeyondLastLine:!1,contextmenu:!1},G={...O},L=t.editorId,I=L==="console"?O:L==="compiled"?W:L==="embed"?G:t.mode==="codeblock"?te:D,w=de({...ee,...I}),oe=({isJSLang:e,isJsx:i,nonReactJsx:p,monaco:g})=>{let h={allowJs:e,checkJs:!e,strictNullChecks:!e,allowNonTsExtensions:!0,experimentalDecorators:!0,emitDecoratorMetadata:!0,allowSyntheticDefaultImports:!0,allowUmdGlobalAccess:!0,esModuleInterop:!0,target:g.languages.typescript.ScriptTarget.ES2020,module:g.languages.typescript.ModuleKind.ESNext,moduleResolution:g.languages.typescript.ModuleResolutionKind.NodeJs,lib:["esnext","dom"]},m={jsx:g.languages.typescript.JsxEmit.ReactJSX,jsxFactory:"React.createElement",reactNamespace:"React",jsxFragmentFactory:"React.Fragment"},b={jsx:g.languages.typescript.JsxEmit.Preserve,jsxFactory:"h",reactNamespace:"h",jsxFragmentFactory:"Fragment"};return{...h,...i?m:{},...p?b:{}}},N=()=>{let e=["javascript","jsx","flow","solid","react-native"],i=["jsx","tsx","sucrase","babel","flow","solid","solid.tsx","react-native","react-native-tsx"],p=e.includes(S),g=i.includes(S),h=["solid","solid.tsx","stencil"].includes(S);if(!["script","tests","editorSettings"].includes(L)||!["javascript","typescript"].includes(y(S)))return;let m=oe({isJSLang:p,isJsx:g,nonReactJsx:h,monaco:u});u.languages.typescript.typescriptDefaults.setCompilerOptions(m),u.languages.typescript.javascriptDefaults.setCompilerOptions(m);let b={noSemanticValidation:S==="flow",diagnosticCodesToIgnore:[2354]};u.languages.typescript.typescriptDefaults.setDiagnosticsOptions(b),u.languages.typescript.javascriptDefaults.setDiagnosticsOptions(b),We({isJSLang:p,editor:f,monaco:u,compilerOptions:m})},C=[],ne=()=>{C.forEach(e=>f.getModel()?.onDidChangeContent(e))},Z="",pe=(e,i,p)=>{let g=ge(),h=T(p),m=y(p)==="typescript"&&!h?.endsWith("ts")&&!h?.endsWith("tsx")?h+".tsx":h;Z=`file:///${L}.${g}.${m}`;let b=e.getModel(),M=u.editor.createModel(i||"",y(p),u.Uri.parse(Z));e.setModel(M),setTimeout(()=>b?.dispose(),1e3),ne(),N()},S=t.language,f=u.editor.create(o,{...w,language:y(S)});pe(f,t.value,S),["markup","style","script","tests"].includes(L)&&J.push(f),w.theme==="vs-light"&&(o.style.backgroundColor="#fff"),(w.theme?.startsWith("http")||w.theme?.startsWith("./"))&&fetch(w.theme).then(e=>e.json()).then(e=>{u.editor.defineTheme("theme",e),u.editor.setTheme("theme"),o.style.backgroundColor=e.colors["editor.background"]});let Fe={astro:n+"monaco-lang-astro.31ace80fb590384d92861650cd635109.js",clio:n+"monaco-lang-clio.bdef68dfea0312fab9a27b5d87146182.js",imba:n+"monaco-lang-imba.b0acc149ca1c00547c24cad4172e8f22.js",wat:n+"monaco-lang-wat.90de1d50eb45ed8f299322a2d8c6f760.js"},_e=async e=>{let i=Fe[e];if(i&&!u.languages.getLanguages().find(p=>p.id===e)){let p=(await import(i)).default;u.languages.register({id:e}),p.config&&u.languages.setLanguageConfiguration(e,p.config),p.tokens&&u.languages.setMonarchTokensProvider(e,p.tokens)}},Ve=()=>L,ze=()=>f.getValue(),Je=(e="")=>{f.getModel()?.setValue(e)},F=[],Q=e=>!e.filename.startsWith("/node_modules/"),Ke=(e,i)=>{let p=e.content,g="file://"+e.filename,h=F.find(m=>m.filename===e.filename);if(h){if(Q(e)&&(h.libJs.dispose(),h.libJs=u.languages.typescript.javascriptDefaults.addExtraLib(p,g)),!i)return;h.libJs?.dispose(),h.libTs?.dispose()}F.push({editorId:L,filename:e.filename,libJs:u.languages.typescript.javascriptDefaults.addExtraLib(p,g),libTs:Q(e)?{dispose:()=>{}}:u.languages.typescript.typescriptDefaults.addExtraLib(p,g)})},X;(()=>{if(L!=="tests")return;let e="javascript",i=J.find(h=>{let m=h.getModel()?.getLanguageId();return e=m||"javascript",["javascript","typescript"].includes(m)});if(!i)return;let p=e==="typescript"?"tsx":"jsx",g=()=>{X=u.editor.createModel(i.getValue(),e,u.Uri.parse("script."+p))};X?(X.dispose(),setTimeout(()=>{g()},300)):g()})();let me=(e=!0)=>{X?.dispose(),L!=="tests"&&(F.filter(i=>i.editorId===L).filter(i=>e?!0:Q(i)).forEach(i=>{i.libJs.dispose(),i.libTs.dispose()}),F=F.filter(i=>i.editorId!==L).filter(i=>e?!1:!Q(i)))},Ge=()=>S,Ze=(e,i)=>{S=e,me(!1),pe(f,i??f.getValue(),S),_e(e)},Qe=()=>f.focus(),Xe=()=>f.layout(),Ye=e=>{C.push(e),f.getModel()?.onDidChangeContent(e)},et={CtrlEnter:u.KeyMod.CtrlCmd|u.KeyCode.Enter,ShiftEnter:u.KeyMod.Shift|u.KeyCode.Enter,Enter:u.KeyCode.Enter,UpArrow:u.KeyCode.UpArrow,DownArrow:u.KeyCode.DownArrow,ShiftAltF:u.KeyMod.Shift|u.KeyMod.Alt|u.KeyCode.KeyF},tt=(e,i,p)=>{f.addAction({id:e,label:e,keybindings:[i],precondition:"!suggestWidgetVisible && !markersNavigationVisible && !findWidgetVisible",run:p})},ue=async e=>{let i=ve(),p=document.querySelector(`#editor-status [data-status="${t.editorId}"]`),g=m=>{i&&(i.textContent=m)},h=m=>{p&&(p.textContent=m)};if(!e){x?.dispose(),x=void 0,h(""),g("");return}if(e==="vim"){if(x?.mode==="vim")return;x?.mode==="emacs"&&(x.dispose(),h(""));let m=await R(Me,"MonacoVim"),b=p?.innerHTML!==""?void 0:p;x=m.initVimMode(f,b),x.mode="vim",g("Vim")}if(e==="emacs"){if(x?.mode==="emacs")return;x?.mode==="vim"&&(x.dispose(),h(""));let m=await R(Le,"MonacoEmacs");x=new m.EmacsExtension(f),h(""),x.onDidMarkChange(function(b){h(b?"Mark Set!":"Mark Unset")}),x.onDidChangeKey(function(b){h(b)}),x.start(),x.mode="emacs",g("Emacs")}};ue(t.editorMode);let ot=e=>{let i=f.getModel();!e||!i||u.languages.registerDocumentFormattingEditProvider(y(S),{provideDocumentFormattingEdits:async()=>{let p=f.getValue(),g=await e(p,0,A());return[{range:i.getFullModelRange(),text:g.formatted}]}})},nt=async()=>f.getAction("editor.action.formatDocument")?.run(),rt=e=>{!e&&!window.emmetMonaco||R(Ee,"emmetMonaco").then(i=>{e?(!j.html||j.disabled)&&(j.html=i.emmetHTML(u,["html","php","astro","markdown","mdx"]),j.css=i.emmetCSS(u,["css","scss","less"]),j.jsx=i.emmetJSX(u,["javascript","typescript","jsx","tsx"]),j.disabled=!1):(j.html?.(),j.css?.(),j.jsx?.(),j.disabled=!0)})},st=e=>{w={...K(e),...I},rt(e.emmet),ue(e.editorMode),f.updateOptions(w),pt(e.enableAI)},it=()=>{f.getModel()?.undo?.()},at=()=>{f.getModel()?.redo?.()},ct=()=>{let e=f.getPosition();return{lineNumber:e?.lineNumber??1,column:e?.column??1}},lt=e=>{let i={lineNumber:e.lineNumber,column:e.column??1};f.setPosition(i),setTimeout(()=>f.revealPositionInCenter(i,0),50)},pt=e=>{if(!e){z?.dispose(),z=void 0;return}z||(z={dispose:()=>"loading..."},import(Te).then(i=>{z=i.registerCodeiumProvider(u,{getEditors:()=>J})}))},mt=()=>{J=J.filter(e=>e!==f),x?.dispose(),C.length=0,me(!0),f.getModel()?.dispose(),f.dispose(),o.innerHTML=""};window.addEventListener("unhandledrejection",function(e){e.reason&&e.reason.name==="Canceled"&&e.preventDefault()});let ut=e=>{let i=["html","markdown","javascript","typescript"],p=f.getModel();if(!p||!i.includes(y(S))||w.autoClosingBrackets==="never")return;let g=h=>["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr","circle","ellipse","line","path","polygon","polyline","rect","stop","use"].includes(h);if(e.browserEvent.key===">"){let h=f.getSelections()||[],m=[],b=[];for(let M of h){b.push(new u.Selection(M.selectionStartLineNumber,M.selectionStartColumn+1,M.endLineNumber,M.endColumn+1));let v=p.getValueInRange({startLineNumber:1,startColumn:1,endLineNumber:M.endLineNumber,endColumn:M.endColumn}).match(/<([\w-]+)(?![^>]*\/>)[^>]*$/);if(!v)continue;let[re,_]=v;g(_)||re.trim().endsWith("/")||m.push({range:{startLineNumber:M.endLineNumber,startColumn:M.endColumn+1,endLineNumber:M.endLineNumber,endColumn:M.endColumn+1},text:`</${_}>`})}setTimeout(()=>{f.executeEdits(p.getValue(),m,b)},0)}};return f.onKeyDown(ut),Oe||(()=>{let e=new Map,i={provideHover(p,g){let h=p.getLineContent(g.lineNumber),m=we(h,!0)[0];if(!m||m.startsWith("https://")||m.startsWith("http://")||m.startsWith(".")||m.startsWith("data:")||m.startsWith("blob:"))return;let b=m.split("/"),M=b[0].startsWith("@")?2:1;return m=b.slice(0,M).join("/"),(async()=>{let q;if(e.has(m))q=e.get(m);else{if(q=await Ue.getPkgInfo(m),"error"in q)return;e.set(m,q)}if(!q||"error"in q)return;let{name:v,description:re="",repo:_=""}=q;return{contents:[{value:`## [${v}](https://www.npmjs.com/package/${v})
${re}


${_?`[GitHub](${_}) |`:""} [Skypack](https://skypack.dev/view/${v}) | [jsDelivr](https://www.jsdelivr.com/package/npm/${v}) | [Unpkg](https://unpkg.com/browse/${v}/) | [Snyk](https://snyk.io/advisor/npm-package/${v}) | [Bundlephobia](https://bundlephobia.com/package/${v})

Docs: [Importing modules](${new URL("/livecodes/docs/",location.href).href}features/module-resolution)`}]}})()}};u.languages.registerHoverProvider("javascript",i),u.languages.registerHoverProvider("typescript",i),u.languages.registerHoverProvider("html",i)})(),Oe=!0,{getValue:ze,setValue:Je,getLanguage:Ge,setLanguage:Ze,getEditorId:Ve,focus:Qe,getPosition:ct,setPosition:lt,layout:Xe,addTypes:Ke,changeSettings:st,onContentChanged:Ye,keyCodes:et,addKeyBinding:tt,registerFormatter:ot,format:nt,isReadonly:r,setTheme:P,undo:it,redo:at,destroy:mt,monaco:f}};export{xo as createEditor};
