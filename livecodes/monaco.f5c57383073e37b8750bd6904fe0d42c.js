var ee=t=>JSON.parse(JSON.stringify(t));var te=()=>String(Math.random())+"-"+Date.now().toFixed();var B=(t,n)=>new Promise((r,s)=>{if(n&&globalThis[n])return r(globalThis[n]);if(typeof globalThis.importScripts=="function")return globalThis.importScripts(t),n&&globalThis[n]?r(globalThis[n]):r(globalThis);let u=document.createElement("script");u.src=t,u.async=!0;let i=()=>{u.removeEventListener("load",p),u.removeEventListener("error",j)},p=()=>{if(i(),!n)return r("loaded: "+t);let g=setInterval(()=>{if(window[n])return clearInterval(g),r(window[n])},5)},j=()=>{i(),s("failed to load: "+t)};u.addEventListener("load",p),u.addEventListener("error",j),document.head.appendChild(u)});var N=t=>t.replace(/\/\*[\s\S]*?\*\/|([^\\:]|^)\/\/.*$/gm,"$1");var ne=["jspm","esm.sh","skypack"],re=["unpkg","jsdelivr","fastly.jsdelivr"],se=["fastly.jsdelivr.gh","jsdelivr.gh","statically"],k={getModuleUrl:(t,{isModule:n=!0,defaultCDN:r="jspm"}={})=>{t=t.replace(/#nobundle/g,"");let s=oe(t,n,r);return s||(n?"https://jspm.dev/"+t:"https://cdn.jsdelivr.net/npm/"+t)},getUrl:(t,n)=>t.startsWith("http")?t:oe(t,!1,n||Je())||t,cdnLists:{npm:re,module:ne,gh:se},checkCDNs:async(t,n)=>{let r=[n,...k.cdnLists.npm].filter(Boolean);for(let s of r)try{if((await fetch(k.getUrl(t,s),{method:"HEAD"})).ok)return s}catch{}return k.cdnLists.npm[0]}},Je=()=>{if(globalThis.appCDN)return globalThis.appCDN;try{return new URL(location.href).searchParams.get("appCDN")||k.cdnLists.npm[0]}catch{return k.cdnLists.npm[0]}},oe=(t,n,r)=>{let s=n&&t.startsWith("unpkg:")?"?module":"";t.startsWith("gh:")?t=t.replace("gh",se[0]):t.includes(":")||(t=(r||(n?ne[0]:re[0]))+":"+t);for(let u of Ge){let[i,p]=u;if(i.test(t))return t.replace(i,p)+s}return null},Ge=[[/^(jspm:)(.+)/i,"https://jspm.dev/$2"],[/^(npm:)(.+)/i,"https://jspm.dev/$2"],[/^(node:)(.+)/i,"https://jspm.dev/$2"],[/^(skypack:)(.+)/i,"https://cdn.skypack.dev/$2"],[/^(jsdelivr:)(.+)/i,"https://cdn.jsdelivr.net/npm/$2"],[/^(fastly.jsdelivr:)(.+)/i,"https://fastly.jsdelivr.net/npm/$2"],[/^(jsdelivr.gh:)(.+)/i,"https://cdn.jsdelivr.net/gh/$2"],[/^(fastly.jsdelivr.gh:)(.+)/i,"https://fastly.jsdelivr.net/gh/$2"],[/^(statically:)(.+)/i,"https://cdn.statically.io/gh/$2"],[/^(esm.run:)(.+)/i,"https://esm.run/$2"],[/^(esm.sh:)(.+)/i,"https://esm.sh/$2"],[/^(esbuild:)(.+)/i,"https://esbuild.vercel.app/$2"],[/^(bundle.run:)(.+)/i,"https://bundle.run/$2"],[/^(unpkg:)(.+)/i,"https://unpkg.com/$2"],[/^(bundlejs:)(.+)/i,"https://deno.bundlejs.com/?file&q=$2"],[/^(bundle:)(.+)/i,"https://deno.bundlejs.com/?file&q=$2"],[/^(deno:)(.+)/i,"https://deno.bundlejs.com/?file&q=https://deno.land/x/$2/mod.ts"],[/^(https:\/\/deno\.land\/.+)/i,"https://deno.bundlejs.com/?file&q=$1"],[/^(github:|https:\/\/github\.com\/)(.[^\/]+?)\/(.[^\/]+?)\/(?!releases\/)(?:(?:blob|raw)\/)?(.+?\/.+)/i,"https://deno.bundlejs.com/?file&q=https://cdn.jsdelivr.net/gh/$2/$3@$4"],[/^(gist\.github:)(.+?\/[0-9a-f]+\/raw\/(?:[0-9a-f]+\/)?.+)$/i,"https://gist.githack.com/$2"],[/^(gitlab:|https:\/\/gitlab\.com\/)([^\/]+.*\/[^\/]+)\/(?:raw|blob)\/(.+?)(?:\?.*)?$/i,"https://deno.bundlejs.com/?file&q=https://gl.githack.com/$2/raw/$3"],[/^(bitbucket:|https:\/\/bitbucket\.org\/)([^\/]+\/[^\/]+)\/(?:raw|src)\/(.+?)(?:\?.*)?$/i,"https://deno.bundlejs.com/?file&q=https://bb.githack.com/$2/raw/$3"],[/^(bitbucket:)snippets\/([^\/]+\/[^\/]+)\/revisions\/([^\/\#\?]+)(?:\?[^#]*)?(?:\#file-(.+?))$/i,"https://bb.githack.com/!api/2.0/snippets/$2/$3/files/$4"],[/^(bitbucket:)snippets\/([^\/]+\/[^\/\#\?]+)(?:\?[^#]*)?(?:\#file-(.+?))$/i,"https://bb.githack.com/!api/2.0/snippets/$2/HEAD/files/$3"],[/^(bitbucket:)\!api\/2.0\/snippets\/([^\/]+\/[^\/]+\/[^\/]+)\/files\/(.+?)(?:\?.*)?$/i,"https://bb.githack.com/!api/2.0/snippets/$2/files/$3"],[/^(api\.bitbucket:)2.0\/snippets\/([^\/]+\/[^\/]+\/[^\/]+)\/files\/(.+?)(?:\?.*)?$/i,"https://bb.githack.com/!api/2.0/snippets/$2/files/$3"],[/^(rawgit:)(.+?\/[0-9a-f]+\/raw\/(?:[0-9a-f]+\/)?.+)$/i,"https://gist.githack.com/$2"],[/^(rawgit:|https:\/\/raw\.githubusercontent\.com)(\/[^\/]+\/[^\/]+|[0-9A-Za-z-]+\/[0-9a-f]+\/raw)\/(.+)/i,"https://deno.bundlejs.com/?file&q=https://raw.githack.com/$2/$3"]];var{getUrl:C,getModuleUrl:at}=k;var ie=C("emmet-monaco-es@5.0.0/dist/emmet-monaco.js");var Ze="0.6.64",mt=C(`malinajs@${Ze}/malina.js`);var le=C("monaco-emacs@0.3.0/dist/monaco-emacs.js"),o=C("monaco-themes@0.4.4/themes/"),ce=C("monaco-vim@0.4.0/dist/monaco-vim.js");var Qe=/(import\s+?(?:(?:(?:[\w*\s{},\$]*)\s+from\s+?)|))((?:".*?")|(?:'.*?'))([\s]*?(?:;|$|))/g,Xe=/(import\s*?\(\s*?((?:".*?")|(?:'.*?'))\s*?\))/g,ae=(t,n=!1)=>[...N(t).matchAll(new RegExp(Qe)),...N(t).matchAll(new RegExp(Xe))].map(r=>r[2].replace(/"/g,"").replace(/'/g,"")).map(r=>!n||!Ye(r)||!r.includes(":")?r:r.split(":")[1]);var Ye=t=>!t.startsWith("https://")&&!t.startsWith("http://")&&!t.startsWith(".")&&!t.startsWith("/")&&!t.startsWith("data:")&&!t.startsWith("blob:");var me=()=>document.querySelector("#editor-mode");var pe=t=>`https://ofcncog2cu-dsn.algolia.net/1/indexes/npm-search/${encodeURIComponent(t)}?x-algolia-agent=Browser`,ue={"X-Algolia-Application-Id":"OFCNCOG2CU","X-Algolia-API-Key":"f54e21fa3a2a0160595bb058179bfb1e"},de=["name","description","homepage","repository.url","version"],O="https://data.jsdelivr.com/v1",F={"User-Agent":"https://livecodes.io"},U=t=>{let n=t.startsWith("@"),r=n?t.slice(1):t,[s,u]=r.split("@");return[(n?"@":"")+s,u]},et=async(t,n=10)=>{let r={page:0,hitsPerPage:n,attributesToHighlight:[],attributesToRetrieve:de,analyticsTags:["jsdelivr"]},[s,u]=U(t),i;if(u){let g=await P(t);typeof g=="string"&&(i=U(g)[1])}let p=await fetch(pe("query"),{method:"POST",headers:{"Content-Type":"application/json; charset=UTF-8",...ue},body:JSON.stringify({query:s,...r})}).then(g=>{if(!g.ok)throw new Error("failed to fetch");return g}).then(g=>g.json()).catch(g=>({error:!0,message:g.mesage||String(g)}));if("error"in p)return p;let j=p.hits.map(g=>(g.name===s&&i&&(g.version=i),g.repository?.url&&(g.repo=g.repository?.url),g));return j.sort((g,D)=>g.name===s?-1:D.name===s?1:0),j},P=async t=>{let n=`${O}/package/resolve/npm/${t}`,r=await fetch(n,{headers:F}).then(i=>{if(!i.ok)throw new Error("failed to fetch");return i}).then(i=>i.json()).catch(i=>({error:!0,message:i.mesage||String(i)}));if("error"in r)return r;let s=U(t)[0],u=r.version;return u?`${s}@${u}`:s},tt=async t=>{let[n,r]=U(t),s;if(r){let p=await P(t);typeof p=="string"&&(s=U(p)[1])}let u=pe(n)+"&attributesToRetrieve="+de.join(","),i=await fetch(u,{method:"GET",headers:ue}).then(p=>{if(!p.ok)throw new Error("failed to fetch");return p}).then(p=>p.json()).catch(p=>({error:!0,message:p.mesage||String(p)}));return"error"in i||(s&&(i.version=s),i.repository?.url&&(i.repo=i.repository?.url)),i},ot=async t=>{let n=await P(t),r=`${O}/package/npm/${n}/flat`,s=await fetch(r,{headers:F}).then(i=>{if(!i.ok)throw new Error("failed to fetch");return i}).then(i=>i.json()).catch(i=>({error:!0,message:i.mesage||String(i)}));if("error"in s)return s;let u=`https://cdn.jsdelivr.net/npm/${n}`;return{...s.default?{default:u+s.default}:{},files:s.files.map(i=>u+i.name)}},nt=async t=>{let n=await P(t),r=`${O}/package/npm/${n}/entrypoints`,s=await fetch(r,{headers:F}).then(i=>{if(!i.ok)throw new Error("failed to fetch");return i}).then(i=>i.json()).catch(i=>({error:!0,message:i.mesage||String(i)}));if("error"in s)return s;let u=`https://cdn.jsdelivr.net/npm/${n}`;return{...s.js?.file?{js:u+s.js?.file}:{},...s.css?.file?{css:u+s.css?.file}:{}}},ge={search:et,getPkgInfo:tt,getPkgFiles:ot,getPkgDefaultFiles:nt};var rt=t=>{let n=t.trim(),r,s;return t.includes(":")&&([r,n]=n.split(":"),r!=="monaco"&&r!=="codemirror"&&r!=="codejar"&&(r=void 0)),t.includes("@")&&([n,s]=n.split("@"),s!=="light"&&s!=="dark"&&(s=void 0)),{editor:r,editorTheme:n,theme:s}},he=({editor:t,editorTheme:n,theme:r,editorThemes:s})=>{if(!n)return null;let i=(typeof n=="string"?n.split(",").map(p=>p.trim()):n).map(rt);for(let p of i)if((p.editor===t||p.editor===void 0)&&(p.theme===r||p.theme===void 0)&&s.includes(p.editorTheme))return p.editorTheme;return null};var _=[{name:"active4d",title:"Active4D",url:o+"Active4D.json"},{name:"all-hallows-eve",title:"All Hallows Eve",url:o+"All Hallows Eve.json"},{name:"amy",title:"Amy",url:o+"Amy.json"},{name:"birds-of-paradise",title:"Birds of Paradise",url:o+"Birds of Paradise.json"},{name:"blackboard",title:"Blackboard",url:o+"Blackboard.json"},{name:"brilliance-black",title:"Brilliance Black",url:o+"Brilliance Black.json"},{name:"brilliance-dull",title:"Brilliance Dull",url:o+"Brilliance Dull.json"},{name:"chrome-devtools",title:"Chrome DevTools",url:o+"Chrome DevTools.json"},{name:"clouds-midnight",title:"Clouds Midnight",url:o+"Clouds Midnight.json"},{name:"clouds",title:"Clouds",url:o+"Clouds.json"},{name:"cobalt",title:"Cobalt",url:o+"Cobalt.json"},{name:"cobalt2",title:"Cobalt2",url:o+"Cobalt2.json"},{name:"dawn",title:"Dawn",url:o+"Dawn.json"},{name:"dracula",title:"Dracula",url:o+"Dracula.json"},{name:"dreamweaver",title:"Dreamweaver",url:o+"Dreamweaver.json"},{name:"eiffel",title:"Eiffel",url:o+"Eiffel.json"},{name:"espresso-libre",title:"Espresso Libre",url:o+"Espresso Libre.json"},{name:"github",title:"GitHub",url:o+"GitHub.json"},{name:"github-dark",title:"GitHub Dark",url:o+"GitHub Dark.json"},{name:"github-light",title:"GitHub Light",url:o+"GitHub Light.json"},{name:"hc-black",title:"High Contrast (Black)"},{name:"hc-light",title:"High Contrast (Light)"},{name:"idle",title:"Idle",url:o+"IDLE.json"},{name:"idlefingers",title:"Idle Fingers",url:o+"idleFingers.json"},{name:"iplastic",title:"iPlastic",url:o+"iPlastic.json"},{name:"katzenmilch",title:"Katzenmilch",url:o+"Katzenmilch.json"},{name:"krtheme",title:"krTheme",url:o+"krTheme.json"},{name:"kuroir",title:"Kuroir Theme",url:o+"Kuroir Theme.json"},{name:"lazy",title:"Lazy",url:o+"LAZY.json"},{name:"magicwb-amiga",title:"MagicWB (Amiga)",url:o+"MagicWB (Amiga).json"},{name:"merbivore-soft",title:"Merbivore Soft",url:o+"Merbivore Soft.json"},{name:"merbivore",title:"Merbivore",url:o+"Merbivore.json"},{name:"monoindustrial",title:"monoindustrial",url:o+"monoindustrial.json"},{name:"monokai",title:"Monokai",url:o+"Monokai.json"},{name:"monokai-bright",title:"Monokai Bright",url:o+"Monokai Bright.json"},{name:"night-owl",title:"Night Owl",url:o+"Night Owl.json"},{name:"nord",title:"Nord",url:o+"Nord.json"},{name:"oceanic-next",title:"Oceanic Next",url:o+"Oceanic Next.json"},{name:"pastels-on-dark",title:"Pastels on Dark",url:o+"Pastels on Dark.json"},{name:"slush-and-poppies",title:"Slush and Poppies",url:o+"Slush and Poppies.json"},{name:"solarized-dark",title:"Solarized Dark",url:o+"Solarized-dark.json"},{name:"solarized-light",title:"Solarized Light",url:o+"Solarized-light.json"},{name:"spacecadet",title:"SpaceCadet",url:o+"SpaceCadet.json"},{name:"sunburst",title:"Sunburst",url:o+"Sunburst.json"},{name:"textmate-mac-classic",title:"Textmate (Mac Classic)",url:o+"Textmate (Mac Classic).json"},{name:"tomorrow",title:"Tomorrow",url:o+"Tomorrow.json"},{name:"tomorrow-night",title:"Tomorrow Night",url:o+"Tomorrow-Night.json"},{name:"tomorrow-night-blue",title:"Tomorrow Night Blue",url:o+"Tomorrow-Night-Blue.json"},{name:"tomorrow-night-bright",title:"Tomorrow Night Bright",url:o+"Tomorrow-Night-Bright.json"},{name:"tomorrow-night-eighties",title:"Tomorrow Night Eighties",url:o+"Tomorrow-Night-Eighties.json"},{name:"twilight",title:"Twilight",url:o+"Twilight.json"},{name:"upstream-sunburst",title:"Upstream Sunburst",url:o+"Upstream Sunburst.json"},{name:"vibrant-ink",title:"Vibrant Ink",url:o+"Vibrant Ink.json"},{name:"vs",title:"VS"},{name:"vs-dark",title:"VS Dark"},{name:"xcode-default",title:"Xcode Default",url:o+"Xcode_default.json"},{name:"zenburnesque",title:"Zenburnesque",url:o+"Zenburnesque.json"}];var fe=!1,M={},c,xe=new Set,Rt=async t=>{let{container:n,baseUrl:r,readonly:s,theme:u,editorTheme:i,isEmbed:p,getLanguageExtension:j,mapLanguage:g,getFormatterConfig:D,getFontFamily:ye}=t;if(!n)throw new Error("editor container not found");let x,V=e=>({fontFamily:ye(e.fontFamily),fontSize:e.fontSize||(p?12:14),insertSpaces:!e.useTabs,detectIndentation:!1,tabSize:e.tabSize,lineNumbers:e.lineNumbers?"on":"off",wordWrap:e.wordWrap?"on":"off",autoClosingBrackets:e.closeBrackets?"always":"never",autoClosingQuotes:e.closeBrackets?"always":"never",autoClosingDelete:e.closeBrackets?"always":"never"}),be=V(t),H=e=>e==="livescript"?"coffeescript":["rescript","reason","ocaml"].includes(e)?"csharp":g(e),T=r+"vendor/monaco-editor/v0.40.0";try{window.monaco=window.monaco||(await import(`${T}/monaco-editor.js`)).monaco,c=window.monaco}catch{throw new Error("Failed to load monaco editor")}c.editor.defineTheme("custom-vs-light",{base:"vs",inherit:!0,rules:[{token:"comment",fontStyle:"italic"}],colors:{}}),c.editor.defineTheme("custom-vs-dark",{base:"vs-dark",inherit:!0,rules:[{token:"comment",fontStyle:"italic"}],colors:{}});let z=async(e,l)=>{let a=he({editor:"monaco",editorTheme:l,theme:e,editorThemes:_.map(m=>m.name)}),h=a==="vs"?"custom-vs-light":a==="vs-dark"?"custom-vs-dark":a||"custom-vs-"+e;if(xe.has(h))return h;let f=_.find(m=>m.name===h);return f?.url&&await fetch(f.url).then(m=>m.json()).then(m=>{c.editor.defineTheme(h,m),xe.add(h)}),h},Ee=(e,l)=>{z(e,l).then(a=>{c.editor.setTheme(a)})},I={theme:await z(u,i),fontLigatures:!0,formatOnType:!1,lineNumbersMinChars:3,minimap:{enabled:!1},scrollbar:{useShadows:!1},mouseWheelZoom:!0,automaticLayout:!0,readOnly:s,fixedOverflowWidgets:!0},Te={...I,scrollBeyondLastLine:!1,contextmenu:!1},Le={...I,scrollBeyondLastLine:!1},K={...I,glyphMargin:!0,folding:!1,lineDecorationsWidth:0,lineNumbersMinChars:0,scrollbar:{vertical:"auto"},scrollBeyondLastLine:!1,contextmenu:!1},Me={...K},v=t.editorId,J=v==="console"?K:v==="compiled"?Le:v==="embed"?Me:t.mode==="codeblock"?Te:I,S=ee({...be,...J});if(!document.head.querySelector("#__livecodes__monaco-styles")){let e=document.createElement("link");e.setAttribute("rel","stylesheet"),e.setAttribute("href",`${T}/monaco-editor.css`),e.id="__livecodes__monaco-styles",document.head.appendChild(e)}window.MonacoEnvironment={getWorkerUrl(e,l){return l==="json"?`${T}/json.worker.js`:l==="css"?`${T}/css.worker.js`:l==="scss"?`${T}/css.worker.js`:l==="sass"?`${T}/css.worker.js`:l==="less"?`${T}/css.worker.js`:l==="html"?`${T}/html.worker.js`:l==="typescript"||l==="javascript"?`${T}/ts.worker.js`:`${T}/editor.worker.js`}};let Se=()=>{let e={jsx:c.languages.typescript.JsxEmit.Preserve,allowNonTsExtensions:!0,allowJs:!1,target:c.languages.typescript.ScriptTarget.Latest,experimentalDecorators:!0,allowSyntheticDefaultImports:!0,lib:["esnext","dom"],module:c.languages.typescript.ModuleKind.ESNext};c.languages.typescript.typescriptDefaults.setCompilerOptions(e),(y==="tsx"||y==="jsx"||y==="sucrase"||y==="babel"||y==="flow")&&c.languages.typescript.typescriptDefaults.setCompilerOptions({...e,jsx:c.languages.typescript.JsxEmit.React,jsxFactory:"React.createElement",reactNamespace:"React"}),y==="stencil"&&c.languages.typescript.typescriptDefaults.setCompilerOptions({...e,jsx:c.languages.typescript.JsxEmit.Preserve,jsxFactory:void 0,reactNamespace:"h"}),y==="flow"?c.languages.typescript.typescriptDefaults.setDiagnosticsOptions({noSemanticValidation:!0}):["typescript"].includes(g(y))&&c.languages.typescript.typescriptDefaults.setDiagnosticsOptions({noSemanticValidation:!1})},$=[],we=()=>{$.forEach(e=>d.getModel()?.onDidChangeContent(e))},G="",Z=(e,l,a)=>{let h=te(),f=j(a),m=H(a)==="typescript"&&!f?.endsWith("ts")&&!f?.endsWith("tsx")?f+".tsx":f;G=`file:///${v}.${h}.${m}`;let E=e.getModel(),b=c.editor.createModel(l||"",H(a),c.Uri.parse(G));e.setModel(b),setTimeout(()=>E?.dispose(),1e3),we(),Se()},y=t.language,d=c.editor.create(n,{...S,language:H(y)});Z(d,t.value,y),S.theme==="vs-light"&&(n.style.backgroundColor="#fff"),(S.theme?.startsWith("http")||S.theme?.startsWith("./"))&&fetch(S.theme).then(e=>e.json()).then(e=>{c.editor.defineTheme("theme",e),c.editor.setTheme("theme"),n.style.backgroundColor=e.colors["editor.background"]});let ke={astro:r+"monaco-lang-astro.31ace80fb590384d92861650cd635109.js",clio:r+"monaco-lang-clio.bdef68dfea0312fab9a27b5d87146182.js",imba:r+"monaco-lang-imba.b0acc149ca1c00547c24cad4172e8f22.js",wat:r+"monaco-lang-wat.90de1d50eb45ed8f299322a2d8c6f760.js"},je=async e=>{let l=ke[e];if(l&&!c.languages.getLanguages().find(a=>a.id===e)){let a=(await import(l)).default;c.languages.register({id:e}),a.config&&c.languages.setLanguageConfiguration(e,a.config),a.tokens&&c.languages.setMonarchTokensProvider(e,a.tokens)}},He=()=>v,ve=()=>d.getValue(),qe=(e="")=>{d.getModel()?.setValue(e)},A=[],R=e=>!e.filename.startsWith("file:///node_modules/"),Q=(e=!0)=>{A.filter(l=>e?!0:R(l)).forEach(l=>{l.libJs.dispose(),l.libTs.dispose()}),A.length=0},Ce=()=>y,Ue=(e,l)=>{y=e,Q(!1),Z(d,l??d.getValue(),y),je(e)},Ie=(e,l=!1)=>{let a=A.find(h=>h.filename===e.filename);if(a){if(R(e)&&(a.libJs.dispose(),a.libJs=c.languages.typescript.javascriptDefaults.addExtraLib(e.content,e.filename)),!l)return;a.libJs?.dispose(),a.libTs?.dispose()}A.push({filename:e.filename,libJs:c.languages.typescript.javascriptDefaults.addExtraLib(e.content,e.filename),libTs:R(e)?{dispose:()=>{}}:c.languages.typescript.typescriptDefaults.addExtraLib(e.content,e.filename)})},Ae=()=>d.focus(),Be=()=>d.layout(),Pe=e=>{$.push(e),d.getModel()?.onDidChangeContent(e)},De={CtrlEnter:c.KeyMod.CtrlCmd|c.KeyCode.Enter,ShiftEnter:c.KeyMod.Shift|c.KeyCode.Enter,Enter:c.KeyCode.Enter,UpArrow:c.KeyCode.UpArrow,DownArrow:c.KeyCode.DownArrow,ShiftAltF:c.KeyMod.Shift|c.KeyMod.Alt|c.KeyCode.KeyF},$e=(e,l,a)=>{d.addAction({id:e,label:e,keybindings:[l],precondition:"!suggestWidgetVisible && !markersNavigationVisible && !findWidgetVisible",run:a})},X=async e=>{let l=me(),a=document.querySelector(`#editor-status [data-status="${t.editorId}"]`),h=m=>{l&&(l.textContent=m)},f=m=>{a&&(a.textContent=m)};if(!e){x?.dispose(),x=void 0,f(""),h("");return}if(e==="vim"){if(x?.mode==="vim")return;x?.mode==="emacs"&&(x.dispose(),f(""));let m=await B(ce,"MonacoVim"),E=a?.innerHTML!==""?void 0:a;x=m.initVimMode(d,E),x.mode="vim",h("Vim")}if(e==="emacs"){if(x?.mode==="emacs")return;x?.mode==="vim"&&(x.dispose(),f(""));let m=await B(le,"MonacoEmacs");x=new m.EmacsExtension(d),f(""),x.onDidMarkChange(function(E){f(E?"Mark Set!":"Mark Unset")}),x.onDidChangeKey(function(E){f(E)}),x.start(),x.mode="emacs",h("Emacs")}};X(t.editorMode);let Re=e=>{let l=d.getModel();!e||!l||c.languages.registerDocumentFormattingEditProvider(H(y),{provideDocumentFormattingEdits:async()=>{let a=d.getValue(),h=await e(a,0,D());return[{range:l.getFullModelRange(),text:h.formatted}]}})},We=async()=>d.getAction("editor.action.formatDocument")?.run(),Y=e=>{!e&&!window.emmetMonaco||B(ie,"emmetMonaco").then(l=>{e?(!M.html||M.disabled)&&(M.html=l.emmetHTML(c,["html","php","astro","markdown","mdx"]),M.css=l.emmetCSS(c,["css","scss","less"]),M.jsx=l.emmetJSX(c,["javascript","typescript","jsx","tsx"]),M.disabled=!1):(M.html?.(),M.css?.(),M.jsx?.(),M.disabled=!0)})},Ne=e=>{S={...V(e),...J},Y(e.emmet),X(e.editorMode),d.updateOptions(S)},Oe=()=>{d.getModel()?.undo?.()},Fe=()=>{d.getModel()?.redo?.()},_e=()=>{let e=d.getPosition();return{lineNumber:e?.lineNumber??1,column:e?.column??1}},Ve=e=>{let l={lineNumber:e.lineNumber,column:e.column??1};d.setPosition(l),setTimeout(()=>d.revealPositionInCenter(l,0),50)},ze=()=>{Y(!1),x?.dispose(),$.length=0,Q(!0),d.getModel()?.dispose(),d.dispose(),n.innerHTML=""};window.addEventListener("unhandledrejection",function(e){e.reason&&e.reason.name==="Canceled"&&e.preventDefault()});let Ke=e=>{let l=["html","markdown","javascript","typescript"],a=d.getModel();if(!a||!l.includes(H(y))||S.autoClosingBrackets==="never")return;let h=f=>["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr","circle","ellipse","line","path","polygon","polyline","rect","stop","use"].includes(f);if(e.browserEvent.key===">"){let f=d.getSelections()||[],m=[],E=[];for(let b of f){E.push(new c.Selection(b.selectionStartLineNumber,b.selectionStartColumn+1,b.endLineNumber,b.endColumn+1));let L=a.getValueInRange({startLineNumber:1,startColumn:1,endLineNumber:b.endLineNumber,endColumn:b.endColumn}).match(/<([\w-]+)(?![^>]*\/>)[^>]*$/);if(!L)continue;let[W,q]=L;h(q)||W.trim().endsWith("/")||m.push({range:{startLineNumber:b.endLineNumber,startColumn:b.endColumn+1,endLineNumber:b.endLineNumber,endColumn:b.endColumn+1},text:`</${q}>`})}setTimeout(()=>{d.executeEdits(a.getValue(),m,E)},0)}};return d.onKeyDown(Ke),fe||(()=>{let e=new Map,l={provideHover(a,h){let f=a.getLineContent(h.lineNumber),m=ae(f,!0)[0];if(!m||m.startsWith("https://")||m.startsWith("http://")||m.startsWith(".")||m.startsWith("data:")||m.startsWith("blob:"))return;let E=m.split("/"),b=E[0].startsWith("@")?2:1;return m=E.slice(0,b).join("/"),(async()=>{let w;if(e.has(m))w=e.get(m);else{if(w=await ge.getPkgInfo(m),"error"in w)return;e.set(m,w)}if(!w||"error"in w)return;let{name:L,description:W="",repo:q=""}=w;return{contents:[{value:`## [${L}](https://www.npmjs.com/package/${L})
${W}


${q?`[GitHub](${q}) |`:""} [Skypack](https://skypack.dev/view/${L}) | [jsDelivr](https://www.jsdelivr.com/package/npm/${L}) | [Unpkg](https://unpkg.com/browse/${L}/) | [Snyk](https://snyk.io/advisor/npm-package/${L}) | [Bundlephobia](https://bundlephobia.com/package/${L})

Docs: [Importing modules](${new URL("/livecodes/docs/",location.href).href}features/module-resolution)`}]}})()}};c.languages.registerHoverProvider("javascript",l),c.languages.registerHoverProvider("typescript",l),c.languages.registerHoverProvider("html",l)})(),fe=!0,{getValue:ve,setValue:qe,getLanguage:Ce,setLanguage:Ue,getEditorId:He,focus:Ae,getPosition:_e,setPosition:Ve,layout:Be,addTypes:Ie,changeSettings:Ne,onContentChanged:Pe,keyCodes:De,addKeyBinding:$e,registerFormatter:Re,format:We,isReadonly:s,setTheme:Ee,undo:Oe,redo:Fe,destroy:ze,monaco:d}};export{Rt as createEditor};
